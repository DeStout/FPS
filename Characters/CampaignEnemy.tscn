[gd_scene load_steps=6 format=3 uid="uid://la6he6vwubnb"]

[ext_resource type="PackedScene" uid="uid://1s5qidco641t" path="res://Characters/CharacterBase.tscn" id="1_rf7ub"]
[ext_resource type="Script" path="res://Characters/CampaignEnemy.gd" id="2_pqw3d"]
[ext_resource type="PackedScene" uid="uid://cy12nf62sv60i" path="res://Debug/VectorCube.tscn" id="3_3vsup"]
[ext_resource type="BehaviorTree" uid="uid://173couunbi78" path="res://Characters/AI/Trees/EnemyTree.tres" id="3_sf323"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_qy0vq"]
var/arrived/name = "arrived"
var/arrived/type = 1
var/arrived/value = false
var/arrived/hint = 0
var/arrived/hint_string = ""
var/agent/name = "agent"
var/agent/type = 22
var/agent/value = NodePath("..")
var/agent/hint = 0
var/agent/hint_string = ""
var/target_visible/name = "target_visible"
var/target_visible/type = 1
var/target_visible/value = false
var/target_visible/hint = 0
var/target_visible/hint_string = ""

[node name="CampaignEnemy" instance=ExtResource("1_rf7ub")]
script = ExtResource("2_pqw3d")

[node name="NameLabel" type="Label3D" parent="." index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.9756, 0)
layers = 16
billboard = 1
text = "Enemy"

[node name="BTree" type="BTPlayer" parent="." index="1"]
behavior_tree = ExtResource("3_sf323")
blackboard_plan = SubResource("BlackboardPlan_qy0vq")

[node name="NavAgent" type="NavigationAgent3D" parent="." index="2"]
debug_enabled = true

[node name="TargetCast" type="RayCast3D" parent="." index="4"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.65, 0)
visible = false
target_position = Vector3(0, 0, -1)
collision_mask = 3
debug_shape_custom_color = Color(0, 0.54902, 0.282353, 1)

[node name="Weapons" parent="." index="5"]
transform = Transform3D(0.846282, -0.0734679, 0.527646, -0.248765, 0.821333, 0.51335, -0.471087, -0.565699, 0.676803, 0.167739, 1.45955, -0.379688)

[node name="Pistol" parent="Weapons" index="1"]
visible = true

[node name="LookHelper" type="Node3D" parent="." index="6"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.65, 0)

[node name="VectorCube" parent="AimHelper" index="0" instance=ExtResource("3_3vsup")]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 0, 0, 0)
visible = false

[node name="ShootCast" parent="AimHelper" index="2"]
visible = false
collision_mask = 13

[node name="Skeleton3D" parent="Puppet" index="2"]
bones/1/position = Vector3(-9.61155e-10, 0.894753, -0.0641973)
bones/2/rotation = Quaternion(-0.142556, 0.000899867, 0.00249804, 0.989783)
bones/4/rotation = Quaternion(0.0841013, 0.0131166, 0.0181786, 0.996205)
bones/5/rotation = Quaternion(-0.0212955, -0.000152978, -0.000954082, 0.999773)
bones/7/rotation = Quaternion(-0.186939, 0.256679, -0.490139, 0.811747)
bones/8/rotation = Quaternion(0.258269, 0.0352185, -0.0502867, 0.96412)
bones/9/rotation = Quaternion(-0.0109506, -0.334453, -0.0161547, 0.94221)
bones/11/rotation = Quaternion(-0.137626, -0.0284945, 0.157495, 0.977467)
bones/14/rotation = Quaternion(0.0637559, -0.171882, -0.0806369, 0.979739)
bones/17/rotation = Quaternion(-0.306326, -0.0310531, 0.273757, 0.911184)
bones/20/rotation = Quaternion(0.1962, 0.11463, 0.511103, 0.828939)
bones/21/rotation = Quaternion(0.697683, -0.0256746, 0.135848, 0.70294)
bones/22/rotation = Quaternion(0.137827, 0.260246, -0.0622723, 0.953623)
bones/24/rotation = Quaternion(-0.133098, 0.0442747, -0.139084, 0.980296)
bones/25/rotation = Quaternion(-0.0620196, 0.0128463, 0.0241589, 0.9977)
bones/27/rotation = Quaternion(0.0965627, 0.160371, 0.10666, 0.976514)
bones/28/rotation = Quaternion(0.0929859, -0.131098, -0.0702993, 0.984492)
bones/30/rotation = Quaternion(-0.525076, -0.385713, 0.593429, 0.472613)
bones/33/rotation = Quaternion(-0.587358, 0.221559, -0.164997, 0.760722)
bones/34/rotation = Quaternion(-0.0808079, 0.00387466, 0.123805, 0.989003)
bones/35/rotation = Quaternion(0.266083, -0.133266, -0.623443, 0.723021)
bones/38/rotation = Quaternion(-0.527568, -0.0618284, 0.330718, 0.780048)
bones/39/rotation = Quaternion(-0.126984, -0.00381051, -0.19455, 0.972631)
bones/40/rotation = Quaternion(0.222019, 0.129427, 0.512473, 0.819346)

[node name="Head" parent="Puppet/Skeleton3D" index="1"]
transform = Transform3D(-0.999987, -0.0049987, 0.000579372, -0.00502312, 0.984652, -0.174457, 0.000301577, -0.174457, -0.984665, -0.000814972, 1.57423, -0.0410825)

[node name="HeadArea" parent="Puppet/Skeleton3D/Head" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Neck" parent="Puppet/Skeleton3D" index="2"]
transform = Transform3D(-0.999995, -0.00306829, 0.00044518, -0.00309198, 0.976338, -0.216228, 0.000228805, -0.216228, -0.976343, -0.000618031, 1.51156, -0.0272038)

[node name="NeckArea" parent="Puppet/Skeleton3D/Neck" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Chest" parent="Puppet/Skeleton3D" index="3"]
transform = Transform3D(-0.999986, 0.00520171, -0.0010695, 0.00490369, 0.981766, 0.190031, 0.00203848, 0.190023, -0.981777, -1.86775e-09, 1.13292, -0.0868667)

[node name="ChestArea" parent="Puppet/Skeleton3D/Chest" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Stomach" parent="Puppet/Skeleton3D" index="4"]
transform = Transform3D(-1, -3.78941e-09, -3.89234e-07, 3.31093e-08, 0.995501, -0.0947544, 3.87842e-07, -0.0947544, -0.995501, -9.61155e-10, 0.894753, -0.0641973)

[node name="StomachArea" parent="Puppet/Skeleton3D/Stomach" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_UpperArm" parent="Puppet/Skeleton3D" index="5"]
transform = Transform3D(0.984986, 0.167536, -0.0416464, 0.149814, -0.709662, 0.68843, 0.0857818, -0.684333, -0.724106, 0.194535, 1.39489, -0.0340955)

[node name="R_UpperArmArea" parent="Puppet/Skeleton3D/R_UpperArm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Forearm" parent="Puppet/Skeleton3D" index="6"]
transform = Transform3D(0.96393, -0.265713, -0.0153872, 0.189322, 0.643874, 0.741339, -0.187076, -0.717512, 0.670954, 0.229495, 1.2468, -0.176897)

[node name="R_ForearmArea" parent="Puppet/Skeleton3D/R_Forearm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Hand" parent="Puppet/Skeleton3D" index="7"]
transform = Transform3D(0.846282, -0.0734679, 0.527646, -0.248765, 0.821333, 0.51335, -0.471087, -0.565699, 0.676803, 0.174946, 1.37899, -0.324197)

[node name="R_HandArea" parent="Puppet/Skeleton3D/R_Hand" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_UpperArm" parent="Puppet/Skeleton3D" index="8"]
transform = Transform3D(0.976805, -0.194341, 0.089912, -0.157218, -0.935967, -0.315038, 0.145379, 0.293595, -0.94481, -0.195386, 1.39425, -0.0340455)

[node name="L_UpperArmArea" parent="Puppet/Skeleton3D/L_UpperArm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Forearm" parent="Puppet/Skeleton3D" index="9"]
transform = Transform3D(0.976309, -0.0104883, 0.216127, -0.052726, -0.980249, 0.190609, 0.209859, -0.197489, -0.957579, -0.23594, 1.19894, 0.0272196)

[node name="L_ForearmArea" parent="Puppet/Skeleton3D/L_Forearm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Hand" parent="Puppet/Skeleton3D" index="10"]
transform = Transform3D(0.893915, 0.0242677, -0.44758, 0.101957, -0.983367, 0.150312, -0.436488, -0.18, -0.88152, -0.238093, 0.997696, -0.0133235)

[node name="L_HandArea" parent="Puppet/Skeleton3D/L_Hand" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Thigh" parent="Puppet/Skeleton3D" index="11"]
transform = Transform3D(0.487095, 0.0599255, 0.871291, -0.294631, -0.927882, 0.228531, 0.82215, -0.368026, -0.434311, 0.0851499, 0.877264, -0.0593682)

[node name="R_ThighArea" parent="Puppet/Skeleton3D/R_Thigh" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Shin" parent="Puppet/Skeleton3D" index="12"]
transform = Transform3D(0.477095, 0.0243383, 0.878515, 0.090926, -0.995619, -0.0217966, 0.874135, 0.0902789, -0.477218, 0.110328, 0.487405, -0.213998)

[node name="R_ShinArea" parent="Puppet/Skeleton3D/R_Shin" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Foot" parent="Puppet/Skeleton3D" index="13"]
transform = Transform3D(0.245938, 0.0720782, 0.966602, -0.853541, -0.456466, 0.25121, 0.459327, -0.886817, -0.0507407, 0.11946, 0.113842, -0.180125)

[node name="R_FootArea" parent="Puppet/Skeleton3D/R_Foot" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Thigh" parent="Puppet/Skeleton3D" index="14"]
transform = Transform3D(0.496995, -0.0515626, -0.86622, -0.112043, -0.99369, -0.00513469, -0.86049, 0.0996062, -0.499636, -0.0851499, 0.877264, -0.0593682)

[node name="L_ThighArea" parent="Puppet/Skeleton3D/L_Thigh" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Shin" parent="Puppet/Skeleton3D" index="15"]
transform = Transform3D(0.49312, -0.0337027, -0.869308, -0.351182, -0.921927, -0.163468, -0.795929, 0.385895, -0.466457, -0.106814, 0.459755, -0.0175177)

[node name="L_ShinArea" parent="Puppet/Skeleton3D/L_Shin" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Foot" parent="Puppet/Skeleton3D" index="16"]
transform = Transform3D(0.245938, -0.0720761, -0.966602, 0.853542, -0.456465, 0.251208, -0.459326, -0.886817, -0.050742, -0.11946, 0.113842, 0.127273)

[node name="L_FootArea" parent="Puppet/Skeleton3D/L_Foot" index="0"]
collision_layer = 8
collision_mask = 1

[node name="VisTimer" type="Timer" parent="." index="10"]
wait_time = 3.0
one_shot = true

[node name="StuckTimer" type="Timer" parent="." index="11"]
wait_time = 3.0
one_shot = true

[node name="ShootTimer" type="Timer" parent="." index="12"]
one_shot = true

[connection signal="velocity_computed" from="NavAgent" to="." method="avoid_velocity"]
[connection signal="timeout" from="VisTimer" to="." method="_player_lost"]
[connection signal="timeout" from="StuckTimer" to="." method="_stuck"]

[editable path="Weapons/Pistol"]
[editable path="Weapons/Pistol/Mesh"]
[editable path="Weapons/SMG"]
[editable path="Weapons/SMG/Mesh"]
[editable path="Weapons/Rifle"]
[editable path="Weapons/Shotgun"]
[editable path="Puppet"]
