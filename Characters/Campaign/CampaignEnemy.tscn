[gd_scene load_steps=10 format=3 uid="uid://la6he6vwubnb"]

[ext_resource type="PackedScene" uid="uid://1s5qidco641t" path="res://Characters/CharacterBase.tscn" id="1_rf7ub"]
[ext_resource type="Script" path="res://Characters/Campaign/CampaignEnemy.gd" id="2_pqw3d"]
[ext_resource type="PackedScene" uid="uid://cy12nf62sv60i" path="res://Debug/VectorCube.tscn" id="3_3vsup"]
[ext_resource type="Script" path="res://addons/StateMachine/StateMachine/state_machine.gd" id="3_7r2cl"]
[ext_resource type="Script" path="res://Characters/Campaign/GuardState.gd" id="3_h5c2t"]
[ext_resource type="PackedScene" uid="uid://bd2fp3xjnl5vp" path="res://Characters/Campaign/VisionCone.tscn" id="3_u6o4h"]
[ext_resource type="Script" path="res://Characters/Campaign/AlertState.gd" id="5_geefd"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_drlm1"]
albedo_color = Color(1, 0.725141, 0.52472, 1)
subsurf_scatter_strength = 1.0
subsurf_scatter_skin_mode = true

[sub_resource type="BoxMesh" id="BoxMesh_tvwkv"]
size = Vector3(0.5, 0.5, 0.5)

[node name="CampaignEnemy" instance=ExtResource("1_rf7ub")]
script = ExtResource("2_pqw3d")
starting_weapon = 0

[node name="NavAgent" type="NavigationAgent3D" parent="." index="0"]
debug_enabled = true

[node name="StateMachine" type="Node" parent="." index="1" node_paths=PackedStringArray("initial_state")]
script = ExtResource("3_7r2cl")
initial_state = NodePath("GuardState")

[node name="GuardState" type="Node" parent="StateMachine" index="0" node_paths=PackedStringArray("enemy")]
script = ExtResource("3_h5c2t")
enemy = NodePath("../..")

[node name="AlertState" type="Node" parent="StateMachine" index="1" node_paths=PackedStringArray("enemy")]
script = ExtResource("5_geefd")
enemy = NodePath("../..")

[node name="TargetCast" type="RayCast3D" parent="." index="3"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.65, 0)
target_position = Vector3(0, 0, -1)
collision_mask = 3
debug_shape_custom_color = Color(0, 0.54902, 0.282353, 1)

[node name="Weapons" parent="." index="4"]
transform = Transform3D(0.846664, -0.0734083, 0.52704, -0.24761, 0.82233, 0.512311, -0.471009, -0.564256, 0.67806, 0.167635, 1.45872, -0.379471)

[node name="LookHelper" type="Node3D" parent="." index="5"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.65, 0)

[node name="VisionCone" parent="LookHelper" index="0" node_paths=PackedStringArray("parent") instance=ExtResource("3_u6o4h")]
unique_name_in_owner = true
transform = Transform3D(10, 0, 0, 0, -4.37114e-07, -10, 0, 10, -4.37114e-07, 0, 0, 0)
visible = false
parent = NodePath("../..")

[node name="VectorCube" parent="AimHelper" index="0" instance=ExtResource("3_3vsup")]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 0, 0, 0)
visible = false

[node name="ShootCast" parent="AimHelper" index="2"]
visible = false
collision_mask = 13

[node name="Skeleton3D" parent="Puppet" index="2"]
bones/1/position = Vector3(-9.73942e-10, 0.894367, -0.0641973)
bones/2/rotation = Quaternion(-0.142294, 0.000896218, 0.00251852, 0.989821)
bones/4/rotation = Quaternion(0.0843162, 0.0131201, 0.0181922, 0.996187)
bones/5/rotation = Quaternion(-0.0209866, -0.000149466, -0.000930474, 0.999779)
bones/7/rotation = Quaternion(-0.186589, 0.25636, -0.490384, 0.811781)
bones/8/rotation = Quaternion(0.258455, 0.0352177, -0.0503226, 0.964069)
bones/9/rotation = Quaternion(-0.0115946, -0.33441, -0.0158027, 0.942224)
bones/11/rotation = Quaternion(-0.137685, -0.0285098, 0.157331, 0.977485)
bones/12/rotation = Quaternion(-0.0728706, -0.00440988, -0.0389535, 0.996571)
bones/14/rotation = Quaternion(0.0636984, -0.171834, -0.0807826, 0.97974)
bones/15/rotation = Quaternion(0.0688573, 0.146545, 0.0441172, 0.985818)
bones/17/rotation = Quaternion(-0.306644, -0.0311015, 0.273137, 0.911262)
bones/18/rotation = Quaternion(-0.0645516, 0.0977242, -0.0941116, 0.988649)
bones/20/rotation = Quaternion(0.195391, 0.114022, 0.511547, 0.82894)
bones/21/rotation = Quaternion(0.698089, -0.0256594, 0.135927, 0.702522)
bones/22/rotation = Quaternion(0.139215, 0.259109, -0.061801, 0.953762)
bones/24/rotation = Quaternion(-0.133511, 0.0444021, -0.139446, 0.980183)
bones/25/rotation = Quaternion(-0.0622909, 0.0126415, 0.0245265, 0.997677)
bones/27/rotation = Quaternion(0.0967781, 0.160252, 0.106871, 0.97649)
bones/28/rotation = Quaternion(0.0923817, -0.131469, -0.0696483, 0.984546)
bones/30/rotation = Quaternion(-0.525655, -0.385955, 0.593573, 0.47159)
bones/31/rotation = Quaternion(-0.291467, -0.110498, 0.336933, 0.888433)
bones/33/rotation = Quaternion(-0.587032, 0.220741, -0.166037, 0.760985)
bones/34/rotation = Quaternion(-0.082466, 0.00387287, 0.126345, 0.988545)
bones/35/rotation = Quaternion(0.266544, -0.133056, -0.624588, 0.721901)
bones/36/rotation = Quaternion(0.00495412, -0.00577786, -0.163837, 0.986458)
bones/38/rotation = Quaternion(-0.527195, -0.0611966, 0.331391, 0.780064)
bones/39/rotation = Quaternion(-0.128064, -0.00380865, -0.196206, 0.972156)
bones/40/rotation = Quaternion(0.222362, 0.129314, 0.513262, 0.818777)
bones/41/rotation = Quaternion(0.00495411, 0.00577787, 0.163837, 0.986458)

[node name="Body" parent="Puppet/Skeleton3D" index="0"]
surface_material_override/0 = SubResource("StandardMaterial3D_drlm1")

[node name="Head" parent="Puppet/Skeleton3D" index="1"]
transform = Transform3D(-0.999988, -0.00487728, 0.000573413, -0.00490207, 0.984376, -0.176011, 0.000294004, -0.176012, -0.984388, -0.00079507, 1.57386, -0.0413434)

[node name="HeadArea" parent="Puppet/Skeleton3D/Head" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Neck" parent="Puppet/Skeleton3D" index="2"]
transform = Transform3D(-0.999995, -0.00299467, 0.000439659, -0.00301869, 0.97613, -0.217166, 0.000221178, -0.217166, -0.976135, -0.000602854, 1.51121, -0.0274044)

[node name="NeckArea" parent="Puppet/Skeleton3D/Neck" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Chest" parent="Puppet/Skeleton3D" index="3"]
transform = Transform3D(-0.999986, 0.00524092, -0.00105783, 0.00494548, 0.981866, 0.189511, 0.00203185, 0.189503, -0.981878, -1.88054e-09, 1.13253, -0.0868667)

[node name="ChestArea" parent="Puppet/Skeleton3D/Chest" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Stomach" parent="Puppet/Skeleton3D" index="4"]
transform = Transform3D(-1, -3.78941e-09, -3.89234e-07, 3.31093e-08, 0.995501, -0.0947544, 3.87842e-07, -0.0947544, -0.995501, -9.73942e-10, 0.894367, -0.0641973)

[node name="StomachArea" parent="Puppet/Skeleton3D/Stomach" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_UpperArm" parent="Puppet/Skeleton3D" index="5"]
transform = Transform3D(0.985124, 0.166818, -0.0412768, 0.149262, -0.711569, 0.686579, 0.0851623, -0.682526, -0.725882, 0.194545, 1.39452, -0.0342335)

[node name="R_UpperArmArea" parent="Puppet/Skeleton3D/R_UpperArm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Forearm" parent="Puppet/Skeleton3D" index="6"]
transform = Transform3D(0.963985, -0.265569, -0.0143391, 0.188195, 0.643045, 0.742345, -0.187923, -0.718308, 0.669865, 0.229356, 1.24604, -0.176658)

[node name="R_ForearmArea" parent="Puppet/Skeleton3D/R_Forearm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Hand" parent="Puppet/Skeleton3D" index="7"]
transform = Transform3D(0.846664, -0.0734083, 0.52704, -0.24761, 0.82233, 0.512311, -0.471009, -0.564256, 0.67806, 0.174836, 1.37805, -0.324122)

[node name="R_HandArea" parent="Puppet/Skeleton3D/R_Hand" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_UpperArm" parent="Puppet/Skeleton3D" index="8"]
transform = Transform3D(0.976866, -0.193992, 0.0900027, -0.156928, -0.936172, -0.314572, 0.145282, 0.293171, -0.944957, -0.195376, 1.39389, -0.0341847)

[node name="L_UpperArmArea" parent="Puppet/Skeleton3D/L_UpperArm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Forearm" parent="Puppet/Skeleton3D" index="9"]
transform = Transform3D(0.976334, -0.00999201, 0.216039, -0.0524065, -0.980091, 0.191507, 0.209825, -0.198297, -0.957419, -0.235856, 1.19854, 0.0269919)

[node name="L_ForearmArea" parent="Puppet/Skeleton3D/L_Forearm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Hand" parent="Puppet/Skeleton3D" index="10"]
transform = Transform3D(0.893922, 0.0242245, -0.447569, 0.101681, -0.983465, 0.149856, -0.436538, -0.179469, -0.881604, -0.237908, 0.997335, -0.0137171)

[node name="L_HandArea" parent="Puppet/Skeleton3D/L_Hand" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Thigh" parent="Puppet/Skeleton3D" index="11"]
transform = Transform3D(0.487168, 0.0600771, 0.87124, -0.296177, -0.92714, 0.229544, 0.821551, -0.369868, -0.433879, 0.0851499, 0.876878, -0.0593682)

[node name="R_ThighArea" parent="Puppet/Skeleton3D/R_Thigh" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Shin" parent="Puppet/Skeleton3D" index="12"]
transform = Transform3D(0.47702, 0.0241696, 0.87856, 0.0926567, -0.995434, -0.0229236, 0.873995, 0.0923395, -0.477081, 0.110392, 0.48733, -0.214772)

[node name="R_ShinArea" parent="Puppet/Skeleton3D/R_Shin" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Foot" parent="Puppet/Skeleton3D" index="13"]
transform = Transform3D(0.245938, 0.0720783, 0.966602, -0.853541, -0.456465, 0.25121, 0.459327, -0.886817, -0.0507407, 0.11946, 0.113837, -0.180126)

[node name="R_FootArea" parent="Puppet/Skeleton3D/R_Foot" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Thigh" parent="Puppet/Skeleton3D" index="14"]
transform = Transform3D(0.497085, -0.0517434, -0.866158, -0.109746, -0.993953, -0.00360513, -0.860734, 0.0968493, -0.499758, -0.0851499, 0.876877, -0.0593682)

[node name="L_ThighArea" parent="Puppet/Skeleton3D/L_Thigh" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Shin" parent="Puppet/Skeleton3D" index="15"]
transform = Transform3D(0.492989, -0.0335019, -0.86939, -0.353787, -0.920633, -0.165139, -0.794856, 0.38899, -0.465715, -0.10689, 0.459258, -0.018676)

[node name="L_ShinArea" parent="Puppet/Skeleton3D/L_Shin" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Foot" parent="Puppet/Skeleton3D" index="16"]
transform = Transform3D(0.245938, -0.072076, -0.966602, 0.853542, -0.456465, 0.251209, -0.459327, -0.886817, -0.0507424, -0.119461, 0.11383, 0.127276)

[node name="L_FootArea" parent="Puppet/Skeleton3D/L_Foot" index="0"]
collision_layer = 8
collision_mask = 1

[node name="TargetTimer" type="Timer" parent="." index="9"]
one_shot = true

[node name="ShootTimer" type="Timer" parent="." index="10"]
one_shot = true

[node name="Debug" type="Node3D" parent="." index="14"]
visible = false

[node name="Box" type="MeshInstance3D" parent="Debug" index="0"]
top_level = true
mesh = SubResource("BoxMesh_tvwkv")

[connection signal="timeout" from="TargetTimer" to="." method="target_lost"]

[editable path="Weapons/Pistol"]
[editable path="Weapons/Pistol/Mesh"]
[editable path="Weapons/SMG"]
[editable path="Weapons/SMG/Mesh"]
[editable path="Weapons/Rifle"]
[editable path="Weapons/Shotgun"]
[editable path="Weapons/Sniper"]
[editable path="Puppet"]
