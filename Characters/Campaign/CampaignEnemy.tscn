[gd_scene load_steps=10 format=3 uid="uid://la6he6vwubnb"]

[ext_resource type="PackedScene" uid="uid://1s5qidco641t" path="res://Characters/CharacterBase.tscn" id="1_rf7ub"]
[ext_resource type="Script" path="res://Characters/Campaign/CampaignEnemy.gd" id="2_pqw3d"]
[ext_resource type="PackedScene" uid="uid://cy12nf62sv60i" path="res://Debug/VectorCube.tscn" id="3_3vsup"]
[ext_resource type="Script" path="res://addons/StateMachine/StateMachine/state_machine.gd" id="3_7r2cl"]
[ext_resource type="Script" path="res://Characters/Campaign/GuardState.gd" id="3_h5c2t"]
[ext_resource type="PackedScene" uid="uid://bd2fp3xjnl5vp" path="res://Characters/Campaign/VisionCone.tscn" id="3_u6o4h"]
[ext_resource type="Script" path="res://Characters/Campaign/AlertState.gd" id="5_geefd"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_drlm1"]
albedo_color = Color(1, 0.725141, 0.52472, 1)
subsurf_scatter_strength = 1.0
subsurf_scatter_skin_mode = true

[sub_resource type="BoxMesh" id="BoxMesh_tvwkv"]
size = Vector3(0.5, 0.5, 0.5)

[node name="CampaignEnemy" instance=ExtResource("1_rf7ub")]
script = ExtResource("2_pqw3d")

[node name="NavAgent" type="NavigationAgent3D" parent="." index="0"]
debug_enabled = true

[node name="StateMachine" type="Node" parent="." index="1" node_paths=PackedStringArray("initial_state")]
script = ExtResource("3_7r2cl")
initial_state = NodePath("GuardState")

[node name="GuardState" type="Node" parent="StateMachine" index="0" node_paths=PackedStringArray("enemy")]
script = ExtResource("3_h5c2t")
enemy = NodePath("../..")

[node name="AlertState" type="Node" parent="StateMachine" index="1" node_paths=PackedStringArray("enemy")]
script = ExtResource("5_geefd")
enemy = NodePath("../..")

[node name="TargetCast" type="RayCast3D" parent="." index="3"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.65, 0)
target_position = Vector3(0, 0, -1)
collision_mask = 3
debug_shape_custom_color = Color(0, 0.54902, 0.282353, 1)

[node name="Weapons" parent="." index="4"]
transform = Transform3D(0.853629, -0.0733451, 0.515692, -0.223698, 0.842468, 0.490109, -0.470401, -0.533731, 0.702748, 0.165404, 1.44182, -0.374814)

[node name="LookHelper" type="Node3D" parent="." index="5"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.65, 0)

[node name="VisionCone" parent="LookHelper" index="0" node_paths=PackedStringArray("parent") instance=ExtResource("3_u6o4h")]
unique_name_in_owner = true
transform = Transform3D(5, 0, 0, 0, -2.18557e-07, -5, 0, 5, -2.18557e-07, 0, 0, 0)
parent = NodePath("../..")

[node name="VectorCube" parent="AimHelper" index="0" instance=ExtResource("3_3vsup")]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 0, 0, 0)
visible = false

[node name="ShootCast" parent="AimHelper" index="2"]
visible = false
collision_mask = 13

[node name="Skeleton3D" parent="Puppet" index="2"]
bones/1/position = Vector3(-1.23303e-09, 0.886542, -0.0641973)
bones/2/rotation = Quaternion(-0.136983, 0.000824451, 0.00293356, 0.990569)
bones/4/rotation = Quaternion(0.0889617, 0.0132269, 0.018489, 0.995776)
bones/5/rotation = Quaternion(-0.014727, -7.69236e-05, -0.000452575, 0.999891)
bones/7/rotation = Quaternion(-0.179048, 0.249625, -0.495561, 0.812433)
bones/8/rotation = Quaternion(0.260752, 0.0352014, -0.0507673, 0.963427)
bones/9/rotation = Quaternion(-0.0241515, -0.333521, -0.00891041, 0.942391)
bones/11/rotation = Quaternion(-0.138807, -0.0288055, 0.154176, 0.97782)
bones/14/rotation = Quaternion(0.0624674, -0.170789, -0.0839015, 0.979739)
bones/17/rotation = Quaternion(-0.313065, -0.0320217, 0.260532, 0.912736)
bones/20/rotation = Quaternion(0.179118, 0.101552, 0.520226, 0.828836)
bones/21/rotation = Quaternion(0.705923, -0.0253612, 0.137452, 0.694361)
bones/22/rotation = Quaternion(0.168051, 0.236587, -0.0513381, 0.955589)
bones/24/rotation = Quaternion(-0.141852, 0.0470375, -0.146757, 0.977818)
bones/25/rotation = Quaternion(-0.0677539, 0.00845588, 0.0319517, 0.997155)
bones/27/rotation = Quaternion(0.101147, 0.157853, 0.111144, 0.97596)
bones/28/rotation = Quaternion(0.0802207, -0.139095, -0.056501, 0.985406)
bones/30/rotation = Quaternion(-0.53707, -0.390951, 0.596371, 0.450616)
bones/33/rotation = Quaternion(-0.581127, 0.20636, -0.184093, 0.765386)
bones/34/rotation = Quaternion(-0.111486, 0.00383536, 0.170806, 0.97897)
bones/35/rotation = Quaternion(0.274511, -0.12923, -0.644587, 0.701749)
bones/38/rotation = Quaternion(-0.519998, -0.0491821, 0.344083, 0.78025)
bones/39/rotation = Quaternion(-0.148417, -0.00377052, -0.227389, 0.96242)
bones/40/rotation = Quaternion(0.228779, 0.127115, 0.528063, 0.807869)

[node name="Body" parent="Puppet/Skeleton3D" index="0"]
surface_material_override/0 = SubResource("StandardMaterial3D_drlm1")

[node name="Head" parent="Puppet/Skeleton3D" index="1"]
transform = Transform3D(-0.999997, -0.00237399, 0.00034097, -0.002393, 0.978131, -0.207974, 0.000160216, -0.207974, -0.978134, -0.000388272, 1.56636, -0.046662)

[node name="HeadArea" parent="Puppet/Skeleton3D/Head" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Neck" parent="Puppet/Skeleton3D" index="2"]
transform = Transform3D(-0.999999, -0.00146014, 0.000243578, -0.0014763, 0.971584, -0.236691, 0.000108946, -0.236691, -0.971585, -0.000294551, 1.504, -0.0314697)

[node name="NeckArea" parent="Puppet/Skeleton3D/Neck" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Chest" parent="Puppet/Skeleton3D" index="3"]
transform = Transform3D(-0.999981, 0.00603775, -0.00083003, 0.00579173, 0.983838, 0.178968, 0.00189718, 0.17896, -0.983854, -2.13962e-09, 1.12471, -0.0868667)

[node name="ChestArea" parent="Puppet/Skeleton3D/Chest" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Stomach" parent="Puppet/Skeleton3D" index="4"]
transform = Transform3D(-1, -3.78941e-09, -3.89234e-07, 3.31093e-08, 0.995501, -0.0947544, 3.87842e-07, -0.0947544, -0.995501, -1.23303e-09, 0.886542, -0.0641973)

[node name="StomachArea" parent="Puppet/Skeleton3D/Stomach" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_UpperArm" parent="Puppet/Skeleton3D" index="5"]
transform = Transform3D(0.987712, 0.152401, -0.034617, 0.138267, -0.748895, 0.648104, 0.0728471, -0.644927, -0.760765, 0.194758, 1.38709, -0.0370309)

[node name="R_UpperArmArea" parent="Puppet/Skeleton3D/R_UpperArm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Forearm" parent="Puppet/Skeleton3D" index="6"]
transform = Transform3D(0.964817, -0.262847, 0.00635284, 0.165326, 0.625286, 0.762683, -0.204441, -0.734799, 0.646741, 0.22656, 1.23081, -0.171609)

[node name="R_ForearmArea" parent="Puppet/Skeleton3D/R_Forearm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Hand" parent="Puppet/Skeleton3D" index="7"]
transform = Transform3D(0.853629, -0.0733451, 0.515692, -0.223698, 0.842468, 0.490109, -0.470401, -0.533731, 0.702748, 0.172599, 1.35918, -0.322459)

[node name="R_HandArea" parent="Puppet/Skeleton3D/R_Hand" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_UpperArm" parent="Puppet/Skeleton3D" index="8"]
transform = Transform3D(0.978125, -0.186539, 0.0920597, -0.150769, -0.940635, -0.304096, 0.143321, 0.283564, -0.948183, -0.195164, 1.38678, -0.0370071)

[node name="L_UpperArmArea" parent="Puppet/Skeleton3D/L_UpperArm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Forearm" parent="Puppet/Skeleton3D" index="9"]
transform = Transform3D(0.9768, -0.00064981, 0.214151, -0.0461945, -0.977093, 0.207741, 0.20911, -0.212814, -0.954454, -0.234089, 1.1905, 0.0221647)

[node name="L_ForearmArea" parent="Puppet/Skeleton3D/L_Forearm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Hand" parent="Puppet/Skeleton3D" index="10"]
transform = Transform3D(0.894045, 0.0230165, -0.447385, 0.0954365, -0.985539, 0.140015, -0.437693, -0.167877, -0.883313, -0.234223, 0.989905, -0.0215245)

[node name="L_HandArea" parent="Puppet/Skeleton3D/L_Hand" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Thigh" parent="Puppet/Skeleton3D" index="11"]
transform = Transform3D(0.488568, 0.0629604, 0.870251, -0.325269, -0.912354, 0.248616, 0.80963, -0.404532, -0.425268, 0.0851499, 0.869052, -0.0593682)

[node name="R_ThighArea" parent="Puppet/Skeleton3D/R_Thigh" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Shin" parent="Puppet/Skeleton3D" index="12"]
transform = Transform3D(0.4756, 0.0209415, 0.879413, 0.125266, -0.991141, -0.0441437, 0.870697, 0.131155, -0.474009, 0.111603, 0.485718, -0.229336)

[node name="R_ShinArea" parent="Puppet/Skeleton3D/R_Shin" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Foot" parent="Puppet/Skeleton3D" index="13"]
transform = Transform3D(0.245939, 0.0720781, 0.966602, -0.853541, -0.456465, 0.25121, 0.459327, -0.886817, -0.050741, 0.119461, 0.113835, -0.180126)

[node name="R_FootArea" parent="Puppet/Skeleton3D/R_Foot" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Thigh" parent="Puppet/Skeleton3D" index="14"]
transform = Transform3D(0.498656, -0.0549676, -0.865056, -0.0696081, -0.997303, 0.0232458, -0.864001, 0.0486232, -0.501137, -0.0851499, 0.869052, -0.0593682)

[node name="L_ThighArea" parent="Puppet/Skeleton3D/L_Thigh" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Shin" parent="Puppet/Skeleton3D" index="15"]
transform = Transform3D(0.490651, -0.0298917, -0.870844, -0.399278, -0.896025, -0.194205, -0.774493, 0.442995, -0.451571, -0.108245, 0.450025, -0.0389387)

[node name="L_ShinArea" parent="Puppet/Skeleton3D/L_Shin" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Foot" parent="Puppet/Skeleton3D" index="16"]
transform = Transform3D(0.245938, -0.0720759, -0.966602, 0.853542, -0.456465, 0.251209, -0.459326, -0.886817, -0.0507425, -0.119461, 0.11383, 0.127276)

[node name="L_FootArea" parent="Puppet/Skeleton3D/L_Foot" index="0"]
collision_layer = 8
collision_mask = 1

[node name="ShootTimer" type="Timer" parent="." index="9"]
one_shot = true

[node name="Debug" type="Node3D" parent="." index="13"]

[node name="Box" type="MeshInstance3D" parent="Debug" index="0"]
top_level = true
mesh = SubResource("BoxMesh_tvwkv")

[connection signal="velocity_computed" from="NavAgent" to="." method="avoid_velocity"]

[editable path="Weapons/Pistol"]
[editable path="Weapons/Pistol/Mesh"]
[editable path="Weapons/SMG"]
[editable path="Weapons/SMG/Mesh"]
[editable path="Weapons/Rifle"]
[editable path="Weapons/Shotgun"]
[editable path="Weapons/Sniper"]
[editable path="Puppet"]
