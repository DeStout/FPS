[gd_scene load_steps=9 format=3 uid="uid://la6he6vwubnb"]

[ext_resource type="PackedScene" uid="uid://1s5qidco641t" path="res://Characters/CharacterBase.tscn" id="1_rf7ub"]
[ext_resource type="Script" path="res://Characters/Campaign/CampaignEnemy.gd" id="2_pqw3d"]
[ext_resource type="PackedScene" uid="uid://cy12nf62sv60i" path="res://Debug/VectorCube.tscn" id="3_3vsup"]
[ext_resource type="Script" path="res://addons/StateMachine/StateMachine/state_machine.gd" id="3_7r2cl"]
[ext_resource type="Script" path="res://Characters/Campaign/GuardState.gd" id="3_h5c2t"]
[ext_resource type="PackedScene" uid="uid://bd2fp3xjnl5vp" path="res://Characters/Campaign/VisionCone.tscn" id="3_u6o4h"]
[ext_resource type="Script" path="res://Characters/Campaign/AlertState.gd" id="5_geefd"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_drlm1"]
albedo_color = Color(1, 0.725141, 0.52472, 1)
subsurf_scatter_strength = 1.0
subsurf_scatter_skin_mode = true

[node name="CampaignEnemy" instance=ExtResource("1_rf7ub")]
script = ExtResource("2_pqw3d")
starting_weapon = 0

[node name="NavAgent" type="NavigationAgent3D" parent="." index="0"]

[node name="StateMachine" type="Node" parent="." index="1" node_paths=PackedStringArray("initial_state")]
script = ExtResource("3_7r2cl")
initial_state = NodePath("GuardState")

[node name="GuardState" type="Node" parent="StateMachine" index="0" node_paths=PackedStringArray("enemy")]
script = ExtResource("3_h5c2t")
enemy = NodePath("../..")

[node name="AlertState" type="Node" parent="StateMachine" index="1" node_paths=PackedStringArray("enemy")]
script = ExtResource("5_geefd")
enemy = NodePath("../..")

[node name="TargetCast" type="RayCast3D" parent="." index="3"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.65, 0)
target_position = Vector3(0, 0, -1)
collision_mask = 3
debug_shape_custom_color = Color(0, 0.54902, 0.282353, 1)

[node name="Weapons" parent="." index="4"]
transform = Transform3D(0.858565, -0.0756259, 0.507096, -0.200244, 0.861044, 0.467446, -0.471983, -0.502876, 0.724119, 0.163078, 1.42623, -0.370022)

[node name="LookHelper" type="Node3D" parent="." index="5"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.65, 0)

[node name="VisionCone" parent="LookHelper" index="0" node_paths=PackedStringArray("parent") instance=ExtResource("3_u6o4h")]
unique_name_in_owner = true
transform = Transform3D(10, 0, 0, 0, -4.37114e-07, -10, 0, 10, -4.37114e-07, 0, 0, 0)
visible = false
parent = NodePath("../..")

[node name="VectorCube" parent="AimHelper" index="0" instance=ExtResource("3_3vsup")]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 0, 0, 0)
visible = false

[node name="ShootCast" parent="AimHelper" index="2"]
visible = false
collision_mask = 13

[node name="Skeleton3D" parent="Puppet" index="2"]
bones/1/position = Vector3(-1.4711e-09, 0.879351, -0.0641973)
bones/2/rotation = Quaternion(-0.132162, 0.000762997, 0.00331076, 0.991222)
bones/4/rotation = Quaternion(0.093223, 0.0133329, 0.0187614, 0.995379)
bones/5/rotation = Quaternion(-0.00905469, -5.25166e-06, -2.03811e-05, 0.999959)
bones/7/rotation = Quaternion(-0.17117, 0.242819, -0.500801, 0.812981)
bones/8/rotation = Quaternion(0.261794, 0.0351792, -0.0509743, 0.963134)
bones/9/rotation = Quaternion(-0.0349066, -0.332688, -0.00294829, 0.942386)
bones/11/rotation = Quaternion(-0.139815, -0.0290678, 0.15134, 0.978112)
bones/14/rotation = Quaternion(0.0613339, -0.169814, -0.0867773, 0.97973)
bones/17/rotation = Quaternion(-0.319019, -0.032762, 0.248728, 0.913941)
bones/20/rotation = Quaternion(0.164191, 0.0896388, 0.527712, 0.828569)
bones/21/rotation = Quaternion(0.712399, -0.0251096, 0.138713, 0.687471)
bones/22/rotation = Quaternion(0.196266, 0.21666, -0.0397876, 0.955487)
bones/24/rotation = Quaternion(-0.14958, 0.0496065, -0.15354, 0.975495)
bones/25/rotation = Quaternion(-0.0727096, 0.00453888, 0.0387327, 0.99659)
bones/27/rotation = Quaternion(0.105129, 0.155697, 0.11503, 0.975435)
bones/28/rotation = Quaternion(0.0690443, -0.14642, -0.0443219, 0.985814)
bones/30/rotation = Quaternion(-0.547132, -0.39585, 0.598781, 0.430593)
bones/33/rotation = Quaternion(-0.576539, 0.195743, -0.19716, 0.768385)
bones/34/rotation = Quaternion(-0.132807, 0.00380031, 0.203473, 0.970024)
bones/35/rotation = Quaternion(0.280256, -0.126227, -0.659261, 0.68622)
bones/38/rotation = Quaternion(-0.513879, -0.0391937, 0.354475, 0.780218)
bones/39/rotation = Quaternion(-0.165023, -0.0037349, -0.252829, 0.953326)
bones/40/rotation = Quaternion(0.23395, 0.125233, 0.540052, 0.798704)

[node name="Body" parent="Puppet/Skeleton3D" index="0"]
surface_material_override/0 = SubResource("StandardMaterial3D_drlm1")

[node name="Head" parent="Puppet/Skeleton3D" index="1"]
transform = Transform3D(-1, -0.000106988, 2.31373e-05, -0.000109429, 0.971543, -0.236862, 2.86598e-06, -0.236862, -0.971543, -1.75436e-05, 1.55941, -0.0514934)

[node name="HeadArea" parent="Puppet/Skeleton3D/Head" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Neck" parent="Puppet/Skeleton3D" index="2"]
transform = Transform3D(-1, -6.58855e-05, 1.41989e-05, -6.73357e-05, 0.967095, -0.254416, 3.03425e-06, -0.254416, -0.967095, -1.33147e-05, 1.49733, -0.0351635)

[node name="NeckArea" parent="Puppet/Skeleton3D/Neck" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Chest" parent="Puppet/Skeleton3D" index="3"]
transform = Transform3D(-0.999977, 0.00676517, -0.000637862, 0.00655937, 0.985528, 0.169386, 0.00177456, 0.169378, -0.98555, -2.3777e-09, 1.11752, -0.0868667)

[node name="ChestArea" parent="Puppet/Skeleton3D/Chest" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Stomach" parent="Puppet/Skeleton3D" index="4"]
transform = Transform3D(-1, -3.78941e-09, -3.89234e-07, 3.31093e-08, 0.995501, -0.0947544, 3.87842e-07, -0.0947544, -0.995501, -1.4711e-09, 0.879351, -0.0641973)

[node name="StomachArea" parent="Puppet/Skeleton3D/Stomach" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_UpperArm" parent="Puppet/Skeleton3D" index="5"]
transform = Transform3D(0.989792, 0.139342, -0.0299354, 0.128458, -0.781244, 0.610866, 0.0617322, -0.608476, -0.791168, 0.194952, 1.38022, -0.0395737)

[node name="R_UpperArmArea" parent="Puppet/Skeleton3D/R_UpperArm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Forearm" parent="Puppet/Skeleton3D" index="6"]
transform = Transform3D(0.965094, -0.260756, 0.02448, 0.144121, 0.606799, 0.78168, -0.218682, -0.750867, 0.623199, 0.224028, 1.2172, -0.166545)

[node name="R_ForearmArea" parent="Puppet/Skeleton3D/R_Forearm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Hand" parent="Puppet/Skeleton3D" index="7"]
transform = Transform3D(0.858565, -0.0756259, 0.507096, -0.200244, 0.861044, 0.467446, -0.471983, -0.502876, 0.724119, 0.170497, 1.34177, -0.320694)

[node name="R_HandArea" parent="Puppet/Skeleton3D/R_Hand" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_UpperArm" parent="Puppet/Skeleton3D" index="8"]
transform = Transform3D(0.979342, -0.178841, 0.0943669, -0.144501, -0.945414, -0.292081, 0.141452, 0.272411, -0.951727, -0.19497, 1.38021, -0.0395728)

[node name="L_UpperArmArea" parent="Puppet/Skeleton3D/L_UpperArm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Forearm" parent="Puppet/Skeleton3D" index="9"]
transform = Transform3D(0.977182, 0.00805304, 0.212253, -0.0403873, -0.974006, 0.222893, 0.208531, -0.226379, -0.951456, -0.232289, 1.18293, 0.0172718)

[node name="L_ForearmArea" parent="Puppet/Skeleton3D/L_Forearm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Hand" parent="Puppet/Skeleton3D" index="10"]
transform = Transform3D(0.89413, 0.0226114, -0.447236, 0.0911525, -0.987005, 0.132334, -0.438432, -0.15909, -0.884572, -0.230636, 0.98297, -0.0292022)

[node name="L_HandArea" parent="Puppet/Skeleton3D/L_Hand" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Thigh" parent="Puppet/Skeleton3D" index="11"]
transform = Transform3D(0.489746, 0.0653751, 0.86941, -0.348989, -0.899114, 0.264197, 0.798972, -0.432804, -0.417523, 0.0851499, 0.861862, -0.0593682)

[node name="R_ThighArea" parent="Puppet/Skeleton3D/R_Thigh" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Shin" parent="Puppet/Skeleton3D" index="12"]
transform = Transform3D(0.474426, 0.0182361, 0.880106, 0.151882, -0.986488, -0.0614323, 0.867094, 0.162817, -0.470785, 0.112618, 0.48409, -0.241215)

[node name="R_ShinArea" parent="Puppet/Skeleton3D/R_Shin" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Foot" parent="Puppet/Skeleton3D" index="13"]
transform = Transform3D(0.245938, 0.0720783, 0.966602, -0.853541, -0.456466, 0.25121, 0.459327, -0.886817, -0.0507409, 0.11946, 0.113953, -0.180125)

[node name="R_FootArea" parent="Puppet/Skeleton3D/R_Foot" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Thigh" parent="Puppet/Skeleton3D" index="14"]
transform = Transform3D(0.499775, -0.0574467, -0.864248, -0.0403016, -0.99826, 0.0430489, -0.865217, 0.0133157, -0.501221, -0.0851499, 0.861862, -0.0593682)

[node name="L_ThighArea" parent="Puppet/Skeleton3D/L_Thigh" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Shin" parent="Puppet/Skeleton3D" index="15"]
transform = Transform3D(0.48884, -0.0271135, -0.871952, -0.432659, -0.875463, -0.215338, -0.757523, 0.482524, -0.439692, -0.109287, 0.442433, -0.0537735)

[node name="L_ShinArea" parent="Puppet/Skeleton3D/L_Shin" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Foot" parent="Puppet/Skeleton3D" index="16"]
transform = Transform3D(0.245938, -0.0720762, -0.966602, 0.853542, -0.456465, 0.251208, -0.459327, -0.886817, -0.0507422, -0.11946, 0.113953, 0.127273)

[node name="L_FootArea" parent="Puppet/Skeleton3D/L_Foot" index="0"]
collision_layer = 8
collision_mask = 1

[node name="TargetTimer" type="Timer" parent="." index="9"]
one_shot = true

[node name="ShootTimer" type="Timer" parent="." index="10"]
one_shot = true

[connection signal="timeout" from="TargetTimer" to="." method="target_lost"]

[editable path="Weapons/Pistol"]
[editable path="Weapons/Pistol/Mesh"]
[editable path="Weapons/SMG"]
[editable path="Weapons/SMG/Mesh"]
[editable path="Weapons/Rifle"]
[editable path="Weapons/Shotgun"]
[editable path="Weapons/Sniper"]
[editable path="Puppet"]
