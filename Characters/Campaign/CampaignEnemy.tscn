[gd_scene load_steps=10 format=3 uid="uid://la6he6vwubnb"]

[ext_resource type="PackedScene" uid="uid://1s5qidco641t" path="res://Characters/CharacterBase.tscn" id="1_rf7ub"]
[ext_resource type="Script" path="res://Characters/Campaign/CampaignEnemy.gd" id="2_pqw3d"]
[ext_resource type="PackedScene" uid="uid://cy12nf62sv60i" path="res://Debug/VectorCube.tscn" id="3_3vsup"]
[ext_resource type="Script" path="res://addons/StateMachine/StateMachine/state_machine.gd" id="3_7r2cl"]
[ext_resource type="Script" path="res://Characters/Campaign/GuardState.gd" id="3_h5c2t"]
[ext_resource type="PackedScene" uid="uid://bd2fp3xjnl5vp" path="res://Characters/Campaign/VisionCone.tscn" id="3_u6o4h"]
[ext_resource type="Script" path="res://Characters/Campaign/AlertState.gd" id="5_geefd"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_drlm1"]
albedo_color = Color(1, 0.725141, 0.52472, 1)
subsurf_scatter_strength = 1.0
subsurf_scatter_skin_mode = true

[sub_resource type="BoxMesh" id="BoxMesh_tvwkv"]
size = Vector3(0.5, 0.5, 0.5)

[node name="CampaignEnemy" instance=ExtResource("1_rf7ub")]
script = ExtResource("2_pqw3d")

[node name="NavAgent" type="NavigationAgent3D" parent="." index="0"]
debug_enabled = true

[node name="StateMachine" type="Node" parent="." index="1" node_paths=PackedStringArray("initial_state")]
script = ExtResource("3_7r2cl")
initial_state = NodePath("GuardState")

[node name="GuardState" type="Node" parent="StateMachine" index="0" node_paths=PackedStringArray("enemy")]
script = ExtResource("3_h5c2t")
enemy = NodePath("../..")

[node name="AlertState" type="Node" parent="StateMachine" index="1" node_paths=PackedStringArray("enemy")]
script = ExtResource("5_geefd")
enemy = NodePath("../..")

[node name="TargetCast" type="RayCast3D" parent="." index="3"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.65, 0)
target_position = Vector3(0, 0, -1)
collision_mask = 3
debug_shape_custom_color = Color(0, 0.54902, 0.282353, 1)

[node name="Weapons" parent="." index="4"]
transform = Transform3D(0.853254, -0.0732728, 0.516322, -0.225192, 0.841243, 0.491528, -0.470367, -0.53567, 0.701294, 0.165548, 1.44285, -0.37511)

[node name="LookHelper" type="Node3D" parent="." index="5"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.65, 0)

[node name="VisionCone" parent="LookHelper" index="0" node_paths=PackedStringArray("parent") instance=ExtResource("3_u6o4h")]
unique_name_in_owner = true
transform = Transform3D(5, 0, 0, 0, -2.18557e-07, -5, 0, 5, -2.18557e-07, 0, 0, 0)
parent = NodePath("../..")

[node name="VectorCube" parent="AimHelper" index="0" instance=ExtResource("3_3vsup")]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 0, 0, 0)
visible = false

[node name="ShootCast" parent="AimHelper" index="2"]
visible = false
collision_mask = 13

[node name="Skeleton3D" parent="Puppet" index="2"]
bones/1/position = Vector3(-1.2172e-09, 0.88702, -0.0641973)
bones/2/rotation = Quaternion(-0.13731, 0.000828806, 0.00290802, 0.990524)
bones/4/rotation = Quaternion(0.0886727, 0.0132222, 0.0184707, 0.995802)
bones/5/rotation = Quaternion(-0.0151094, -8.15439e-05, -0.000481741, 0.999886)
bones/7/rotation = Quaternion(-0.17954, 0.250054, -0.495229, 0.812395)
bones/8/rotation = Quaternion(0.261118, 0.0351924, -0.0508405, 0.963324)
bones/9/rotation = Quaternion(-0.0234157, -0.333575, -0.00931624, 0.942387)
bones/11/rotation = Quaternion(-0.138736, -0.0287864, 0.154374, 0.9778)
bones/14/rotation = Quaternion(0.0625349, -0.170847, -0.0837301, 0.97974)
bones/17/rotation = Quaternion(-0.312674, -0.0319694, 0.261304, 0.912652)
bones/20/rotation = Quaternion(0.180103, 0.102323, 0.519715, 0.828848)
bones/21/rotation = Quaternion(0.705468, -0.0253788, 0.137364, 0.694839)
bones/22/rotation = Quaternion(0.166245, 0.237928, -0.0520353, 0.955534)
bones/24/rotation = Quaternion(-0.141344, 0.0468729, -0.146312, 0.977966)
bones/25/rotation = Quaternion(-0.0674223, 0.00871392, 0.0314995, 0.997189)
bones/27/rotation = Quaternion(0.100877, 0.158, 0.11088, 0.975995)
bones/28/rotation = Quaternion(0.0809581, -0.138623, -0.0573013, 0.985366)
bones/30/rotation = Quaternion(-0.536391, -0.390638, 0.596206, 0.451912)
bones/33/rotation = Quaternion(-0.581451, 0.207127, -0.183141, 0.765162)
bones/34/rotation = Quaternion(-0.109943, 0.00383766, 0.168443, 0.979553)
bones/35/rotation = Quaternion(0.274091, -0.129441, -0.643525, 0.702848)
bones/38/rotation = Quaternion(-0.520416, -0.0498711, 0.343361, 0.780246)
bones/39/rotation = Quaternion(-0.147261, -0.00377284, -0.225618, 0.963014)
bones/40/rotation = Quaternion(0.228417, 0.127243, 0.527225, 0.808498)

[node name="Body" parent="Puppet/Skeleton3D" index="0"]
surface_material_override/0 = SubResource("StandardMaterial3D_drlm1")

[node name="Head" parent="Puppet/Skeleton3D" index="1"]
transform = Transform3D(-0.999997, -0.00252759, 0.000354183, -0.00254633, 0.978546, -0.206013, 0.000174131, -0.206013, -0.978549, -0.000413346, 1.56682, -0.0463345)

[node name="HeadArea" parent="Puppet/Skeleton3D/Head" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Neck" parent="Puppet/Skeleton3D" index="2"]
transform = Transform3D(-0.999999, -0.00155483, 0.000252767, -0.00157062, 0.971876, -0.235486, 0.000120481, -0.235486, -0.971878, -0.000313547, 1.50444, -0.0312196)

[node name="NeckArea" parent="Puppet/Skeleton3D/Neck" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Chest" parent="Puppet/Skeleton3D" index="3"]
transform = Transform3D(-0.999982, 0.00598864, -0.000843678, 0.00573971, 0.98372, 0.179617, 0.00190561, 0.179609, -0.983736, -2.12379e-09, 1.12519, -0.0868667)

[node name="ChestArea" parent="Puppet/Skeleton3D/Chest" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Stomach" parent="Puppet/Skeleton3D" index="4"]
transform = Transform3D(-1, -3.78941e-09, -3.89234e-07, 3.31093e-08, 0.995501, -0.0947544, 3.87842e-07, -0.0947544, -0.995501, -1.2172e-09, 0.88702, -0.0641973)

[node name="StomachArea" parent="Puppet/Skeleton3D/Stomach" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_UpperArm" parent="Puppet/Skeleton3D" index="5"]
transform = Transform3D(0.987565, 0.15327, -0.0349744, 0.138923, -0.746685, 0.650509, 0.0735886, -0.647279, -0.758693, 0.194745, 1.38754, -0.0368588)

[node name="R_UpperArmArea" parent="Puppet/Skeleton3D/R_UpperArm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Forearm" parent="Puppet/Skeleton3D" index="6"]
transform = Transform3D(0.964783, -0.262999, 0.00512459, 0.166721, 0.626435, 0.761436, -0.203467, -0.733765, 0.648221, 0.226728, 1.23173, -0.171928)

[node name="R_ForearmArea" parent="Puppet/Skeleton3D/R_Forearm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Hand" parent="Puppet/Skeleton3D" index="7"]
transform = Transform3D(0.853254, -0.0732728, 0.516322, -0.225192, 0.841243, 0.491528, -0.470367, -0.53567, 0.701294, 0.172736, 1.36033, -0.322565)

[node name="R_HandArea" parent="Puppet/Skeleton3D/R_Hand" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_UpperArm" parent="Puppet/Skeleton3D" index="8"]
transform = Transform3D(0.978047, -0.187019, 0.0919156, -0.151165, -0.940343, -0.304803, 0.143436, 0.284217, -0.94797, -0.195177, 1.38722, -0.0368334)

[node name="L_UpperArmArea" parent="Puppet/Skeleton3D/L_UpperArm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Forearm" parent="Puppet/Skeleton3D" index="9"]
transform = Transform3D(0.976777, -0.000860393, 0.214256, -0.0464233, -0.977087, 0.207717, 0.209168, -0.21284, -0.954436, -0.234203, 1.19099, 0.0224747)

[node name="L_ForearmArea" parent="Puppet/Skeleton3D/L_Forearm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Hand" parent="Puppet/Skeleton3D" index="10"]
transform = Transform3D(0.894032, 0.0234268, -0.447391, 0.096494, -0.985263, 0.141235, -0.437489, -0.169439, -0.883116, -0.234379, 0.990403, -0.0212198)

[node name="L_HandArea" parent="Puppet/Skeleton3D/L_Hand" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Thigh" parent="Puppet/Skeleton3D" index="11"]
transform = Transform3D(0.488487, 0.0627944, 0.870309, -0.323617, -0.913236, 0.247532, 0.810341, -0.402563, -0.425783, 0.0851499, 0.86953, -0.0593682)

[node name="R_ThighArea" parent="Puppet/Skeleton3D/R_Thigh" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Shin" parent="Puppet/Skeleton3D" index="12"]
transform = Transform3D(0.475681, 0.0211274, 0.879364, 0.123414, -0.991426, -0.0429392, 0.870917, 0.128951, -0.47421, 0.111534, 0.485825, -0.228509)

[node name="R_ShinArea" parent="Puppet/Skeleton3D/R_Shin" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Foot" parent="Puppet/Skeleton3D" index="13"]
transform = Transform3D(0.245939, 0.0720783, 0.966602, -0.853541, -0.456465, 0.25121, 0.459327, -0.886817, -0.0507408, 0.119461, 0.113835, -0.180126)

[node name="R_FootArea" parent="Puppet/Skeleton3D/R_Foot" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Thigh" parent="Puppet/Skeleton3D" index="14"]
transform = Transform3D(0.498574, -0.0547922, -0.865114, -0.0717345, -0.997185, 0.0218157, -0.863874, 0.0511817, -0.501101, -0.0851499, 0.86953, -0.0593682)

[node name="L_ThighArea" parent="Puppet/Skeleton3D/L_Thigh" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Shin" parent="Puppet/Skeleton3D" index="15"]
transform = Transform3D(0.490779, -0.0300883, -0.870765, -0.39686, -0.89743, -0.192668, -0.775654, 0.440129, -0.45238, -0.108171, 0.450553, -0.0378637)

[node name="L_ShinArea" parent="Puppet/Skeleton3D/L_Shin" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Foot" parent="Puppet/Skeleton3D" index="16"]
transform = Transform3D(0.245939, -0.0720758, -0.966602, 0.853542, -0.456465, 0.251209, -0.459326, -0.886817, -0.0507427, -0.119461, 0.113831, 0.127276)

[node name="L_FootArea" parent="Puppet/Skeleton3D/L_Foot" index="0"]
collision_layer = 8
collision_mask = 1

[node name="TargetTimer" type="Timer" parent="." index="9"]
one_shot = true

[node name="ShootTimer" type="Timer" parent="." index="10"]
one_shot = true

[node name="Debug" type="Node3D" parent="." index="14"]

[node name="Box" type="MeshInstance3D" parent="Debug" index="0"]
top_level = true
mesh = SubResource("BoxMesh_tvwkv")

[connection signal="velocity_computed" from="NavAgent" to="." method="avoid_velocity"]
[connection signal="timeout" from="TargetTimer" to="." method="target_lost"]

[editable path="Weapons/Pistol"]
[editable path="Weapons/Pistol/Mesh"]
[editable path="Weapons/SMG"]
[editable path="Weapons/SMG/Mesh"]
[editable path="Weapons/Rifle"]
[editable path="Weapons/Shotgun"]
[editable path="Weapons/Sniper"]
[editable path="Puppet"]
