[gd_scene load_steps=9 format=3 uid="uid://la6he6vwubnb"]

[ext_resource type="PackedScene" uid="uid://1s5qidco641t" path="res://Characters/CharacterBase.tscn" id="1_rf7ub"]
[ext_resource type="Script" path="res://Characters/Campaign/CampaignEnemy.gd" id="2_pqw3d"]
[ext_resource type="PackedScene" uid="uid://cy12nf62sv60i" path="res://Debug/VectorCube.tscn" id="3_3vsup"]
[ext_resource type="Script" path="res://addons/StateMachine/StateMachine/state_machine.gd" id="3_7r2cl"]
[ext_resource type="Script" path="res://Characters/Campaign/GuardState.gd" id="3_h5c2t"]
[ext_resource type="PackedScene" uid="uid://bd2fp3xjnl5vp" path="res://Characters/Campaign/VisionCone.tscn" id="3_u6o4h"]
[ext_resource type="Script" path="res://Characters/Campaign/AlertState.gd" id="5_geefd"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_drlm1"]
albedo_color = Color(1, 0.725141, 0.52472, 1)
subsurf_scatter_strength = 1.0
subsurf_scatter_skin_mode = true

[node name="CampaignEnemy" instance=ExtResource("1_rf7ub")]
script = ExtResource("2_pqw3d")
starting_weapon = 0

[node name="NavAgent" type="NavigationAgent3D" parent="." index="0"]

[node name="StateMachine" type="Node" parent="." index="1" node_paths=PackedStringArray("initial_state")]
script = ExtResource("3_7r2cl")
initial_state = NodePath("GuardState")

[node name="GuardState" type="Node" parent="StateMachine" index="0" node_paths=PackedStringArray("enemy")]
script = ExtResource("3_h5c2t")
enemy = NodePath("../..")

[node name="AlertState" type="Node" parent="StateMachine" index="1" node_paths=PackedStringArray("enemy")]
script = ExtResource("5_geefd")
enemy = NodePath("../..")

[node name="TargetCast" type="RayCast3D" parent="." index="3"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.65, 0)
visible = false
target_position = Vector3(0, 0, -1)
collision_mask = 3
debug_shape_custom_color = Color(0, 0.54902, 0.282353, 1)

[node name="LookHelper" type="Node3D" parent="." index="5"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.65, 0)
visible = false

[node name="VisionCone" parent="LookHelper" index="0" node_paths=PackedStringArray("parent") instance=ExtResource("3_u6o4h")]
unique_name_in_owner = true
transform = Transform3D(10, 0, 0, 0, -4.37114e-07, -10, 0, 10, -4.37114e-07, 0, 0, 0)
parent = NodePath("../..")

[node name="Weapons" parent="." index="6"]
transform = Transform3D(0.853949, -0.0734049, 0.515153, -0.222421, 0.843513, 0.488892, -0.470425, -0.532069, 0.70399, 0.165281, 1.44094, -0.374558)

[node name="VectorCube" parent="AimHelper" index="0" instance=ExtResource("3_3vsup")]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 0, 0, 0)
visible = false

[node name="ShootCast" parent="AimHelper" index="2"]
collision_mask = 13

[node name="Skeleton3D" parent="Puppet" index="2"]
bones/1/position = Vector3(-1.24657e-09, 0.886133, -0.0641973)
bones/2/rotation = Quaternion(-0.136704, 0.000820724, 0.0029554, 0.990607)
bones/4/rotation = Quaternion(0.0892089, 0.0132329, 0.0185048, 0.995753)
bones/5/rotation = Quaternion(-0.0143998, -7.29702e-05, -0.000427619, 0.999896)
bones/7/rotation = Quaternion(-0.178633, 0.249259, -0.495842, 0.812466)
bones/8/rotation = Quaternion(0.260791, 0.0352006, -0.050775, 0.963416)
bones/9/rotation = Quaternion(-0.024781, -0.333474, -0.00856316, 0.942395)
bones/11/rotation = Quaternion(-0.138866, -0.0288212, 0.154009, 0.977838)
bones/14/rotation = Quaternion(0.0624062, -0.170737, -0.0840567, 0.979739)
bones/17/rotation = Quaternion(-0.3134, -0.0320665, 0.259872, 0.912808)
bones/20/rotation = Quaternion(0.178274, 0.100892, 0.520661, 0.828825)
bones/21/rotation = Quaternion(0.706311, -0.0253463, 0.137528, 0.693951)
bones/22/rotation = Quaternion(0.169596, 0.235439, -0.0507413, 0.955631)
bones/24/rotation = Quaternion(-0.142287, 0.0471782, -0.147138, 0.977691)
bones/25/rotation = Quaternion(-0.0680376, 0.0082351, 0.0323386, 0.997125)
bones/27/rotation = Quaternion(0.101378, 0.157727, 0.11137, 0.975931)
bones/28/rotation = Quaternion(0.0795897, -0.1395, -0.0558161, 0.985439)
bones/30/rotation = Quaternion(-0.537649, -0.391218, 0.596511, 0.449506)
bones/33/rotation = Quaternion(-0.58085, 0.205704, -0.184907, 0.765578)
bones/34/rotation = Quaternion(-0.112805, 0.00383337, 0.172827, 0.978464)
bones/35/rotation = Quaternion(0.274869, -0.12905, -0.645494, 0.700807)
bones/38/rotation = Quaternion(-0.51964, -0.0485924, 0.344701, 0.780253)
bones/39/rotation = Quaternion(-0.149406, -0.00376853, -0.228904, 0.961908)
bones/40/rotation = Quaternion(0.229089, 0.127005, 0.528779, 0.80733)

[node name="Body" parent="Puppet/Skeleton3D" index="0"]
surface_material_override/0 = SubResource("StandardMaterial3D_drlm1")

[node name="Head" parent="Puppet/Skeleton3D" index="1"]
transform = Transform3D(-0.999997, -0.00224244, 0.000325484, -0.00226085, 0.977774, -0.209651, 0.000151884, -0.209651, -0.977776, -0.000366814, 1.56597, -0.0469422)

[node name="HeadArea" parent="Puppet/Skeleton3D/Head" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Neck" parent="Puppet/Skeleton3D" index="2"]
transform = Transform3D(-0.999999, -0.0013791, 0.000231683, -0.00139464, 0.971332, -0.237721, 0.000102801, -0.237721, -0.971333, -0.000278296, 1.50362, -0.0316838)

[node name="NeckArea" parent="Puppet/Skeleton3D/Neck" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Chest" parent="Puppet/Skeleton3D" index="3"]
transform = Transform3D(-0.999981, 0.00607978, -0.000818377, 0.00583623, 0.983938, 0.178413, 0.00188994, 0.178405, -0.983955, -2.15316e-09, 1.1243, -0.0868667)

[node name="ChestArea" parent="Puppet/Skeleton3D/Chest" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Stomach" parent="Puppet/Skeleton3D" index="4"]
transform = Transform3D(-1, -3.78941e-09, -3.89234e-07, 3.31093e-08, 0.995501, -0.0947544, 3.87842e-07, -0.0947544, -0.995501, -1.24657e-09, 0.886133, -0.0641973)

[node name="StomachArea" parent="Puppet/Skeleton3D/Stomach" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_UpperArm" parent="Puppet/Skeleton3D" index="5"]
transform = Transform3D(0.987838, 0.151656, -0.034313, 0.137703, -0.75078, 0.646041, 0.0722145, -0.642908, -0.762532, 0.194769, 1.3867, -0.0371782)

[node name="R_UpperArmArea" parent="Puppet/Skeleton3D/R_UpperArm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Forearm" parent="Puppet/Skeleton3D" index="6"]
transform = Transform3D(0.964845, -0.262716, 0.00740452, 0.164129, 0.624301, 0.763747, -0.205271, -0.735682, 0.645473, 0.226415, 1.23003, -0.171335)

[node name="R_ForearmArea" parent="Puppet/Skeleton3D/R_Forearm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Hand" parent="Puppet/Skeleton3D" index="7"]
transform = Transform3D(0.853949, -0.0734049, 0.515153, -0.222421, 0.843513, 0.488892, -0.470425, -0.532069, 0.70399, 0.172481, 1.3582, -0.322366)

[node name="R_HandArea" parent="Puppet/Skeleton3D/R_Hand" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_UpperArm" parent="Puppet/Skeleton3D" index="8"]
transform = Transform3D(0.978192, -0.186131, 0.0921753, -0.150432, -0.940882, -0.3035, 0.143217, 0.283015, -0.948362, -0.195153, 1.38641, -0.0371559)

[node name="L_UpperArmArea" parent="Puppet/Skeleton3D/L_UpperArm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Forearm" parent="Puppet/Skeleton3D" index="9"]
transform = Transform3D(0.976824, -0.000203416, 0.214046, -0.0458846, -0.976952, 0.208472, 0.20907, -0.213462, -0.954319, -0.233993, 1.19007, 0.0219015)

[node name="L_ForearmArea" parent="Puppet/Skeleton3D/L_Forearm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Hand" parent="Puppet/Skeleton3D" index="10"]
transform = Transform3D(0.89405, 0.0229322, -0.447381, 0.0950673, -0.985654, 0.13946, -0.437764, -0.167215, -0.883403, -0.234035, 0.98951, -0.0219207)

[node name="L_HandArea" parent="Puppet/Skeleton3D/L_Hand" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Thigh" parent="Puppet/Skeleton3D" index="11"]
transform = Transform3D(0.488637, 0.0631023, 0.870202, -0.326682, -0.911596, 0.249543, 0.80902, -0.406215, -0.424826, 0.0851499, 0.868643, -0.0593682)

[node name="R_ThighArea" parent="Puppet/Skeleton3D/R_Thigh" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Shin" parent="Puppet/Skeleton3D" index="12"]
transform = Transform3D(0.47553, 0.0207823, 0.879454, 0.126851, -0.990892, -0.0451739, 0.870506, 0.133041, -0.473836, 0.111663, 0.485627, -0.230044)

[node name="R_ShinArea" parent="Puppet/Skeleton3D/R_Shin" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Foot" parent="Puppet/Skeleton3D" index="13"]
transform = Transform3D(0.245939, 0.0720782, 0.966602, -0.853541, -0.456465, 0.25121, 0.459327, -0.886817, -0.0507408, 0.119461, 0.113837, -0.180126)

[node name="R_FootArea" parent="Puppet/Skeleton3D/R_Foot" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Thigh" parent="Puppet/Skeleton3D" index="14"]
transform = Transform3D(0.498726, -0.0551175, -0.865005, -0.0677884, -0.9974, 0.0244694, -0.864105, 0.0464338, -0.501166, -0.0851499, 0.868643, -0.0593682)

[node name="L_ThighArea" parent="Puppet/Skeleton3D/L_Thigh" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Shin" parent="Puppet/Skeleton3D" index="15"]
transform = Transform3D(0.490542, -0.0297229, -0.870911, -0.401343, -0.894817, -0.195518, -0.773494, 0.445443, -0.450874, -0.108308, 0.449576, -0.0398586)

[node name="L_ShinArea" parent="Puppet/Skeleton3D/L_Shin" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Foot" parent="Puppet/Skeleton3D" index="16"]
transform = Transform3D(0.245938, -0.0720761, -0.966602, 0.853542, -0.456465, 0.251209, -0.459326, -0.886817, -0.0507423, -0.11946, 0.113834, 0.127275)

[node name="L_FootArea" parent="Puppet/Skeleton3D/L_Foot" index="0"]
collision_layer = 8
collision_mask = 1

[node name="TargetTimer" type="Timer" parent="." index="9"]
one_shot = true

[node name="ShootTimer" type="Timer" parent="." index="10"]
one_shot = true

[connection signal="timeout" from="TargetTimer" to="." method="target_lost"]

[editable path="Weapons/Pistol"]
[editable path="Weapons/Pistol/Mesh"]
[editable path="Weapons/SMG"]
[editable path="Weapons/SMG/Mesh"]
[editable path="Weapons/Rifle"]
[editable path="Weapons/Shotgun"]
[editable path="Weapons/Sniper"]
[editable path="Puppet"]
