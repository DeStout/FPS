[gd_scene load_steps=9 format=3 uid="uid://la6he6vwubnb"]

[ext_resource type="PackedScene" uid="uid://1s5qidco641t" path="res://Characters/CharacterBase.tscn" id="1_rf7ub"]
[ext_resource type="Script" path="res://Characters/Campaign/CampaignEnemy.gd" id="2_pqw3d"]
[ext_resource type="PackedScene" uid="uid://cy12nf62sv60i" path="res://Debug/VectorCube.tscn" id="3_3vsup"]
[ext_resource type="Script" path="res://addons/StateMachine/StateMachine/state_machine.gd" id="3_7r2cl"]
[ext_resource type="Script" path="res://Characters/Campaign/GuardState.gd" id="3_h5c2t"]
[ext_resource type="PackedScene" uid="uid://bd2fp3xjnl5vp" path="res://Characters/Campaign/VisionCone.tscn" id="3_u6o4h"]
[ext_resource type="Script" path="res://Characters/Campaign/AlertState.gd" id="5_geefd"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_drlm1"]
albedo_color = Color(1, 0.725141, 0.52472, 1)
subsurf_scatter_strength = 1.0
subsurf_scatter_skin_mode = true

[node name="CampaignEnemy" instance=ExtResource("1_rf7ub")]
script = ExtResource("2_pqw3d")
starting_weapon = 0

[node name="NavAgent" type="NavigationAgent3D" parent="." index="0"]

[node name="StateMachine" type="Node" parent="." index="1" node_paths=PackedStringArray("initial_state")]
script = ExtResource("3_7r2cl")
initial_state = NodePath("GuardState")

[node name="GuardState" type="Node" parent="StateMachine" index="0" node_paths=PackedStringArray("enemy")]
script = ExtResource("3_h5c2t")
enemy = NodePath("../..")

[node name="AlertState" type="Node" parent="StateMachine" index="1" node_paths=PackedStringArray("enemy")]
script = ExtResource("5_geefd")
enemy = NodePath("../..")

[node name="TargetCast" type="RayCast3D" parent="." index="3"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.65, 0)
visible = false
target_position = Vector3(0, 0, -1)
collision_mask = 3
debug_shape_custom_color = Color(0, 0.54902, 0.282353, 1)

[node name="Weapons" parent="." index="4"]
transform = Transform3D(0.854582, -0.0735712, 0.514079, -0.219767, 0.845671, 0.486357, -0.470524, -0.52861, 0.706526, 0.165023, 1.43912, -0.374027)

[node name="LookHelper" type="Node3D" parent="." index="5"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.65, 0)
visible = false

[node name="VisionCone" parent="LookHelper" index="0" node_paths=PackedStringArray("parent") instance=ExtResource("3_u6o4h")]
unique_name_in_owner = true
transform = Transform3D(10, 0, 0, 0, -4.37114e-07, -10, 0, 10, -4.37114e-07, 0, 0, 0)
parent = NodePath("../..")

[node name="VectorCube" parent="AimHelper" index="0" instance=ExtResource("3_3vsup")]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 0, 0, 0)
visible = false

[node name="ShootCast" parent="AimHelper" index="2"]
collision_mask = 13

[node name="Skeleton3D" parent="Puppet" index="2"]
bones/1/position = Vector3(-1.27446e-09, 0.88529, -0.0641973)
bones/2/rotation = Quaternion(-0.13613, 0.000813211, 0.00300027, 0.990686)
bones/4/rotation = Quaternion(0.0897163, 0.0132456, 0.0185373, 0.995707)
bones/5/rotation = Quaternion(-0.0137258, -6.44534e-05, -0.000376226, 0.999906)
bones/7/rotation = Quaternion(-0.17776, 0.248496, -0.49643, 0.812532)
bones/8/rotation = Quaternion(0.260874, 0.0351988, -0.0507914, 0.963393)
bones/9/rotation = Quaternion(-0.0260621, -0.333378, -0.00785564, 0.9424)
bones/11/rotation = Quaternion(-0.138984, -0.0288522, 0.153677, 0.977872)
bones/14/rotation = Quaternion(0.0622758, -0.170625, -0.0843875, 0.979739)
bones/17/rotation = Quaternion(-0.314088, -0.0321569, 0.258512, 0.912955)
bones/20/rotation = Quaternion(0.176541, 0.0995282, 0.521551, 0.828802)
bones/21/rotation = Quaternion(0.7071, -0.0253159, 0.137681, 0.693118)
bones/22/rotation = Quaternion(0.172802, 0.233094, -0.0494826, 0.955698)
bones/24/rotation = Quaternion(-0.143181, 0.0474701, -0.147922, 0.977428)
bones/25/rotation = Quaternion(-0.068621, 0.00777906, 0.033135, 0.997062)
bones/27/rotation = Quaternion(0.101852, 0.157469, 0.111832, 0.975871)
bones/28/rotation = Quaternion(0.0782928, -0.140336, -0.054407, 0.985503)
bones/30/rotation = Quaternion(-0.538836, -0.391774, 0.596798, 0.447215)
bones/33/rotation = Quaternion(-0.580292, 0.204394, -0.18653, 0.765957)
bones/34/rotation = Quaternion(-0.115441, 0.00382933, 0.176866, 0.977434)
bones/35/rotation = Quaternion(0.275583, -0.128686, -0.647309, 0.698916)
bones/38/rotation = Quaternion(-0.518913, -0.0473968, 0.345951, 0.780257)
bones/39/rotation = Quaternion(-0.151407, -0.00376442, -0.231969, 0.96086)
bones/40/rotation = Quaternion(0.229714, 0.126782, 0.530227, 0.806237)

[node name="Body" parent="Puppet/Skeleton3D" index="0"]
surface_material_override/0 = SubResource("StandardMaterial3D_drlm1")

[node name="Head" parent="Puppet/Skeleton3D" index="1"]
transform = Transform3D(-0.999998, -0.00197218, 0.000291041, -0.0019889, 0.977029, -0.213097, 0.000135908, -0.213097, -0.977031, -0.000322736, 1.56516, -0.0475173)

[node name="HeadArea" parent="Puppet/Skeleton3D/Head" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Neck" parent="Puppet/Skeleton3D" index="2"]
transform = Transform3D(-0.999999, -0.00121284, 0.000205843, -0.00122681, 0.970813, -0.239835, 9.10442e-05, -0.239835, -0.970814, -0.000244889, 1.50284, -0.0321233)

[node name="NeckArea" parent="Puppet/Skeleton3D/Neck" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Chest" parent="Puppet/Skeleton3D" index="3"]
transform = Transform3D(-0.999981, 0.00616616, -0.000794796, 0.0059276, 0.984144, 0.177273, 0.00187529, 0.177265, -0.984161, -2.18106e-09, 1.12346, -0.0868667)

[node name="ChestArea" parent="Puppet/Skeleton3D/Chest" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Stomach" parent="Puppet/Skeleton3D" index="4"]
transform = Transform3D(-1, -3.78941e-09, -3.89234e-07, 3.31093e-08, 0.995501, -0.0947544, 3.87842e-07, -0.0947544, -0.995501, -1.27446e-09, 0.88529, -0.0641973)

[node name="StomachArea" parent="Puppet/Skeleton3D/Stomach" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_UpperArm" parent="Puppet/Skeleton3D" index="5"]
transform = Transform3D(0.988091, 0.150131, -0.033708, 0.136553, -0.754634, 0.641779, 0.0709135, -0.638739, -0.766148, 0.194792, 1.3859, -0.0374807)

[node name="R_UpperArmArea" parent="Puppet/Skeleton3D/R_UpperArm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Forearm" parent="Puppet/Skeleton3D" index="6"]
transform = Transform3D(0.964897, -0.262456, 0.00955154, 0.161672, 0.622247, 0.765944, -0.20697, -0.737513, 0.642836, 0.22612, 1.22842, -0.170768)

[node name="R_ForearmArea" parent="Puppet/Skeleton3D/R_Forearm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Hand" parent="Puppet/Skeleton3D" index="7"]
transform = Transform3D(0.854582, -0.0735712, 0.514079, -0.219767, 0.845671, 0.486357, -0.470524, -0.52861, 0.706526, 0.172239, 1.35617, -0.322175)

[node name="R_HandArea" parent="Puppet/Skeleton3D/R_Hand" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_UpperArm" parent="Puppet/Skeleton3D" index="8"]
transform = Transform3D(0.978331, -0.185276, 0.0924242, -0.14973, -0.941402, -0.302233, 0.143005, 0.281845, -0.948743, -0.195129, 1.38564, -0.0374611)

[node name="L_UpperArmArea" parent="Puppet/Skeleton3D/L_UpperArm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Forearm" parent="Puppet/Skeleton3D" index="9"]
transform = Transform3D(0.976871, 0.000734996, 0.213831, -0.0452384, -0.976649, 0.210025, 0.208992, -0.214841, -0.954026, -0.233791, 1.1892, 0.0213521)

[node name="L_ForearmArea" parent="Puppet/Skeleton3D/L_Forearm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Hand" parent="Puppet/Skeleton3D" index="10"]
transform = Transform3D(0.89406, 0.0227891, -0.447368, 0.0943677, -0.985874, 0.138372, -0.437895, -0.16593, -0.883581, -0.233641, 0.988696, -0.0227533)

[node name="L_HandArea" parent="Puppet/Skeleton3D/L_Hand" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Thigh" parent="Puppet/Skeleton3D" index="11"]
transform = Transform3D(0.488778, 0.0633907, 0.870102, -0.32954, -0.91005, 0.251419, 0.807774, -0.409622, -0.423922, 0.0851499, 0.867801, -0.0593682)

[node name="R_ThighArea" parent="Puppet/Skeleton3D/R_Thigh" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Shin" parent="Puppet/Skeleton3D" index="12"]
transform = Transform3D(0.475389, 0.0204596, 0.879538, 0.130057, -0.99038, -0.0472578, 0.870109, 0.136856, -0.473477, 0.111784, 0.485434, -0.231475)

[node name="R_ShinArea" parent="Puppet/Skeleton3D/R_Shin" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Foot" parent="Puppet/Skeleton3D" index="13"]
transform = Transform3D(0.245939, 0.0720784, 0.966602, -0.853541, -0.456465, 0.25121, 0.459327, -0.886817, -0.0507406, 0.119461, 0.113837, -0.180126)

[node name="R_FootArea" parent="Puppet/Skeleton3D/R_Foot" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Thigh" parent="Puppet/Skeleton3D" index="14"]
transform = Transform3D(0.498866, -0.0554196, -0.864906, -0.0641578, -0.997577, 0.0269152, -0.864301, 0.0420633, -0.501212, -0.0851499, 0.867801, -0.0593682)

[node name="L_ThighArea" parent="Puppet/Skeleton3D/L_Thigh" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Shin" parent="Puppet/Skeleton3D" index="15"]
transform = Transform3D(0.490321, -0.0293854, -0.871046, -0.405473, -0.892374, -0.19814, -0.771477, 0.450338, -0.449465, -0.108435, 0.448659, -0.0416949)

[node name="L_ShinArea" parent="Puppet/Skeleton3D/L_Shin" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Foot" parent="Puppet/Skeleton3D" index="16"]
transform = Transform3D(0.245938, -0.0720761, -0.966602, 0.853542, -0.456465, 0.251209, -0.459326, -0.886817, -0.0507423, -0.119461, 0.113834, 0.127275)

[node name="L_FootArea" parent="Puppet/Skeleton3D/L_Foot" index="0"]
collision_layer = 8
collision_mask = 1

[node name="TargetTimer" type="Timer" parent="." index="9"]
one_shot = true

[node name="ShootTimer" type="Timer" parent="." index="10"]
one_shot = true

[connection signal="timeout" from="TargetTimer" to="." method="target_lost"]

[editable path="Weapons/Pistol"]
[editable path="Weapons/Pistol/Mesh"]
[editable path="Weapons/SMG"]
[editable path="Weapons/SMG/Mesh"]
[editable path="Weapons/Rifle"]
[editable path="Weapons/Shotgun"]
[editable path="Weapons/Sniper"]
[editable path="Puppet"]
