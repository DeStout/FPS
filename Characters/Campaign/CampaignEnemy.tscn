[gd_scene load_steps=10 format=3 uid="uid://la6he6vwubnb"]

[ext_resource type="PackedScene" uid="uid://1s5qidco641t" path="res://Characters/CharacterBase.tscn" id="1_rf7ub"]
[ext_resource type="Script" path="res://Characters/Campaign/CampaignEnemy.gd" id="2_pqw3d"]
[ext_resource type="PackedScene" uid="uid://cy12nf62sv60i" path="res://Debug/VectorCube.tscn" id="3_3vsup"]
[ext_resource type="Script" path="res://addons/StateMachine/StateMachine/state_machine.gd" id="3_7r2cl"]
[ext_resource type="Script" path="res://Characters/Campaign/GuardState.gd" id="3_h5c2t"]
[ext_resource type="PackedScene" uid="uid://bd2fp3xjnl5vp" path="res://Characters/Campaign/VisionCone.tscn" id="3_u6o4h"]
[ext_resource type="Script" path="res://Characters/Campaign/AlertState.gd" id="5_geefd"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_drlm1"]
albedo_color = Color(1, 0.725141, 0.52472, 1)
subsurf_scatter_strength = 1.0
subsurf_scatter_skin_mode = true

[sub_resource type="BoxMesh" id="BoxMesh_tvwkv"]
size = Vector3(0.5, 0.5, 0.5)

[node name="CampaignEnemy" instance=ExtResource("1_rf7ub")]
script = ExtResource("2_pqw3d")

[node name="NavAgent" type="NavigationAgent3D" parent="." index="0"]

[node name="StateMachine" type="Node" parent="." index="1" node_paths=PackedStringArray("initial_state")]
script = ExtResource("3_7r2cl")
initial_state = NodePath("GuardState")

[node name="GuardState" type="Node" parent="StateMachine" index="0" node_paths=PackedStringArray("enemy")]
script = ExtResource("3_h5c2t")
enemy = NodePath("../..")

[node name="AlertState" type="Node" parent="StateMachine" index="1" node_paths=PackedStringArray("enemy")]
script = ExtResource("5_geefd")
enemy = NodePath("../..")

[node name="TargetCast" type="RayCast3D" parent="." index="3"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.65, 0)
target_position = Vector3(0, 0, -1)
collision_mask = 3
debug_shape_custom_color = Color(0, 0.54902, 0.282353, 1)

[node name="Weapons" parent="." index="4"]
transform = Transform3D(0.842994, -0.0741554, 0.532787, -0.25874, 0.812454, 0.522467, -0.471609, -0.57829, 0.665707, 0.168584, 1.46503, -0.381939)

[node name="LookHelper" type="Node3D" parent="." index="5"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.65, 0)

[node name="VisionCone" parent="LookHelper" index="0" node_paths=PackedStringArray("parent") instance=ExtResource("3_u6o4h")]
unique_name_in_owner = true
transform = Transform3D(10, 0, 0, 0, -4.37114e-07, -10, 0, 10, -4.37114e-07, 0, 0, 0)
parent = NodePath("../..")

[node name="VectorCube" parent="AimHelper" index="0" instance=ExtResource("3_3vsup")]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 0, 0, 0)
visible = false

[node name="ShootCast" parent="AimHelper" index="2"]
visible = false
collision_mask = 13

[node name="Skeleton3D" parent="Puppet" index="2"]
bones/1/position = Vector3(-8.81538e-10, 0.897158, -0.0641973)
bones/2/rotation = Quaternion(-0.143812, 0.000917615, 0.00240002, 0.989602)
bones/4/rotation = Quaternion(0.0822759, 0.0131009, 0.0180736, 0.99636)
bones/5/rotation = Quaternion(-0.0236298, -0.000152923, -0.00113241, 0.99972)
bones/7/rotation = Quaternion(-0.189584, 0.259125, -0.488273, 0.811481)
bones/8/rotation = Quaternion(0.256547, 0.0352151, -0.0499589, 0.964597)
bones/9/rotation = Quaternion(-0.0056793, -0.3348, -0.0190279, 0.94208)
bones/11/rotation = Quaternion(-0.13736, -0.0284236, 0.158243, 0.977386)
bones/12/rotation = Quaternion(-0.0728706, -0.00440988, -0.0389535, 0.996571)
bones/14/rotation = Quaternion(0.0638516, -0.171963, -0.0803947, 0.979739)
bones/15/rotation = Quaternion(0.0688573, 0.146545, 0.0441172, 0.985818)
bones/17/rotation = Quaternion(-0.303785, -0.0306461, 0.278712, 0.910547)
bones/18/rotation = Quaternion(-0.0645516, 0.0977242, -0.0941116, 0.988649)
bones/20/rotation = Quaternion(0.202696, 0.119445, 0.507478, 0.828923)
bones/21/rotation = Quaternion(0.694344, -0.0257995, 0.135198, 0.706358)
bones/22/rotation = Quaternion(0.126953, 0.269473, -0.0658024, 0.952333)
bones/24/rotation = Quaternion(-0.129792, 0.0432726, -0.136189, 0.98119)
bones/25/rotation = Quaternion(-0.0598744, 0.0144498, 0.0212581, 0.997875)
bones/27/rotation = Quaternion(0.0949378, 0.161275, 0.105068, 0.976698)
bones/28/rotation = Quaternion(0.0978341, -0.128163, -0.0755096, 0.984023)
bones/30/rotation = Quaternion(-0.520387, -0.383825, 0.592264, 0.480727)
bones/31/rotation = Quaternion(-0.291467, -0.110498, 0.336933, 0.888433)
bones/33/rotation = Quaternion(-0.590302, 0.229099, -0.155351, 0.758237)
bones/34/rotation = Quaternion(-0.0655299, 0.00389091, 0.100397, 0.992779)
bones/35/rotation = Quaternion(0.261813, -0.135164, -0.61289, 0.733179)
bones/36/rotation = Quaternion(0.00495412, -0.00577786, -0.163837, 0.986458)
bones/38/rotation = Quaternion(-0.530687, -0.0671366, 0.325038, 0.779881)
bones/39/rotation = Quaternion(-0.117852, -0.00382554, -0.18056, 0.97647)
bones/40/rotation = Quaternion(0.219107, 0.130374, 0.505787, 0.82412)
bones/41/rotation = Quaternion(0.00495411, 0.00577787, 0.163837, 0.986458)

[node name="Body" parent="Puppet/Skeleton3D" index="0"]
surface_material_override/0 = SubResource("StandardMaterial3D_drlm1")

[node name="Head" parent="Puppet/Skeleton3D" index="1"]
transform = Transform3D(-0.999983, -0.00581289, 0.000527078, -0.00582074, 0.986485, -0.163746, 0.000431878, -0.163746, -0.986502, -0.000916866, 1.57657, -0.0397333)

[node name="HeadArea" parent="Puppet/Skeleton3D/Head" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Neck" parent="Puppet/Skeleton3D" index="2"]
transform = Transform3D(-0.999994, -0.00352455, 0.000441853, -0.0035387, 0.977658, -0.210172, 0.00030878, -0.210173, -0.977664, -0.000690639, 1.51382, -0.0262432)

[node name="NeckArea" parent="Puppet/Skeleton3D/Neck" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Chest" parent="Puppet/Skeleton3D" index="3"]
transform = Transform3D(-0.999987, 0.00501416, -0.00112622, 0.00470354, 0.981282, 0.192521, 0.00207047, 0.192513, -0.981292, -1.78813e-09, 1.13533, -0.0868667)

[node name="ChestArea" parent="Puppet/Skeleton3D/Chest" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Stomach" parent="Puppet/Skeleton3D" index="4"]
transform = Transform3D(-1, -3.78941e-09, -3.89234e-07, 3.31093e-08, 0.995501, -0.0947544, 3.87842e-07, -0.0947544, -0.995501, -8.81538e-10, 0.897158, -0.0641973)

[node name="StomachArea" parent="Puppet/Skeleton3D/Stomach" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_UpperArm" parent="Puppet/Skeleton3D" index="5"]
transform = Transform3D(0.983866, 0.173239, -0.0446873, 0.154326, -0.695413, 0.701844, 0.0905104, -0.697416, -0.710928, 0.194485, 1.3972, -0.0334348)

[node name="R_UpperArmArea" parent="Puppet/Skeleton3D/R_UpperArm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Forearm" parent="Puppet/Skeleton3D" index="6"]
transform = Transform3D(0.963451, -0.266823, -0.0238204, 0.197922, 0.649092, 0.734511, -0.180523, -0.71238, 0.678178, 0.230635, 1.25208, -0.178966)

[node name="R_ForearmArea" parent="Puppet/Skeleton3D/R_Forearm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Hand" parent="Puppet/Skeleton3D" index="7"]
transform = Transform3D(0.842994, -0.0741554, 0.532787, -0.25874, 0.812454, 0.522467, -0.471609, -0.57829, 0.665707, 0.175858, 1.38534, -0.325213)

[node name="R_HandArea" parent="Puppet/Skeleton3D/R_Hand" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_UpperArm" parent="Puppet/Skeleton3D" index="8"]
transform = Transform3D(0.97631, -0.197117, 0.0892353, -0.159312, -0.933927, -0.319999, 0.146417, 0.298202, -0.943206, -0.195436, 1.39648, -0.0333788)

[node name="L_UpperArmArea" parent="Puppet/Skeleton3D/L_UpperArm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Forearm" parent="Puppet/Skeleton3D" index="9"]
transform = Transform3D(0.976102, -0.0145971, 0.216821, -0.0550416, -0.981814, 0.181692, 0.210226, -0.189284, -0.959154, -0.236569, 1.20159, 0.0288477)

[node name="L_ForearmArea" parent="Puppet/Skeleton3D/L_Forearm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Hand" parent="Puppet/Skeleton3D" index="10"]
transform = Transform3D(0.89386, 0.0245636, -0.447673, 0.103457, -0.982852, 0.152642, -0.436247, -0.182756, -0.881073, -0.239566, 1.00003, -0.010011)

[node name="L_HandArea" parent="Puppet/Skeleton3D/L_Hand" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Thigh" parent="Puppet/Skeleton3D" index="11"]
transform = Transform3D(0.486481, 0.0586582, 0.87172, -0.281574, -0.933982, 0.219986, 0.827075, -0.352473, -0.437848, 0.0851499, 0.879668, -0.0593682)

[node name="R_ThighArea" parent="Puppet/Skeleton3D/R_Thigh" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Shin" parent="Puppet/Skeleton3D" index="12"]
transform = Transform3D(0.477727, 0.0257577, 0.878131, 0.076301, -0.997009, -0.0122651, 0.875189, 0.0728616, -0.478264, 0.109796, 0.487247, -0.207463)

[node name="R_ShinArea" parent="Puppet/Skeleton3D/R_Shin" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Foot" parent="Puppet/Skeleton3D" index="13"]
transform = Transform3D(0.245938, 0.0720782, 0.966602, -0.853541, -0.456466, 0.25121, 0.459327, -0.886817, -0.0507408, 0.11946, 0.113162, -0.180125)

[node name="R_FootArea" parent="Puppet/Skeleton3D/R_Foot" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Thigh" parent="Puppet/Skeleton3D" index="14"]
transform = Transform3D(0.496142, -0.049923, -0.866805, -0.133286, -0.990891, -0.0192204, -0.85795, 0.125069, -0.498276, -0.0851499, 0.879668, -0.0593682)

[node name="L_ThighArea" parent="Puppet/Skeleton3D/L_Thigh" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Shin" parent="Puppet/Skeleton3D" index="15"]
transform = Transform3D(0.494301, -0.0355383, -0.868564, -0.327217, -0.933282, -0.148033, -0.805355, 0.357382, -0.47295, -0.106126, 0.463336, -0.00681937)

[node name="L_ShinArea" parent="Puppet/Skeleton3D/L_Shin" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Foot" parent="Puppet/Skeleton3D" index="16"]
transform = Transform3D(0.245938, -0.0720729, -0.966602, 0.853542, -0.456465, 0.251207, -0.459326, -0.886817, -0.050745, -0.11946, 0.113162, 0.127273)

[node name="L_FootArea" parent="Puppet/Skeleton3D/L_Foot" index="0"]
collision_layer = 8
collision_mask = 1

[node name="TargetTimer" type="Timer" parent="." index="9"]
one_shot = true

[node name="ShootTimer" type="Timer" parent="." index="10"]
one_shot = true

[node name="Debug" type="Node3D" parent="." index="14"]

[node name="Box" type="MeshInstance3D" parent="Debug" index="0"]
top_level = true
mesh = SubResource("BoxMesh_tvwkv")

[connection signal="velocity_computed" from="NavAgent" to="." method="avoid_velocity"]
[connection signal="timeout" from="TargetTimer" to="." method="target_lost"]

[editable path="Weapons/Pistol"]
[editable path="Weapons/Pistol/Mesh"]
[editable path="Weapons/SMG"]
[editable path="Weapons/SMG/Mesh"]
[editable path="Weapons/Rifle"]
[editable path="Weapons/Shotgun"]
[editable path="Weapons/Sniper"]
[editable path="Puppet"]
