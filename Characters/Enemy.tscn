[gd_scene load_steps=8 format=3 uid="uid://la6he6vwubnb"]

[ext_resource type="PackedScene" uid="uid://1s5qidco641t" path="res://Characters/CharacterBase.tscn" id="1_rf7ub"]
[ext_resource type="Script" path="res://Characters/Enemy.gd" id="2_pqw3d"]
[ext_resource type="PackedScene" uid="uid://cy12nf62sv60i" path="res://Debug/VectorCube.tscn" id="3_3vsup"]
[ext_resource type="BehaviorTree" uid="uid://173couunbi78" path="res://Characters/AI/Trees/EnemyTree.tres" id="3_sf323"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_32mig"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_0bpq3"]
albedo_color = Color(0.372549, 0.376471, 0.784314, 1)

[sub_resource type="BoxMesh" id="BoxMesh_m0eni"]
material = SubResource("StandardMaterial3D_0bpq3")
size = Vector3(0.3, 0.3, 0.3)

[node name="Enemy" instance=ExtResource("1_rf7ub")]
script = ExtResource("2_pqw3d")

[node name="BTPlayer" type="BTPlayer" parent="." index="0"]
behavior_tree = ExtResource("3_sf323")
blackboard_plan = SubResource("BlackboardPlan_32mig")

[node name="NameLabel" type="Label3D" parent="." index="1"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.9756, 0)
layers = 16
billboard = 1
text = "Enemy"

[node name="NavAgent" type="NavigationAgent3D" parent="." index="2"]
target_desired_distance = 3.0

[node name="NavTarget" type="Marker3D" parent="." index="3"]
top_level = true
visible = false

[node name="MeshInstance3D" type="MeshInstance3D" parent="NavTarget" index="0"]
mesh = SubResource("BoxMesh_m0eni")

[node name="PlayerCast" type="RayCast3D" parent="." index="5"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.65, 0)
visible = false
target_position = Vector3(0, 0, -1)
collision_mask = 3
debug_shape_custom_color = Color(0, 0.54902, 0.282353, 1)

[node name="Weapons" parent="." index="6"]
transform = Transform3D(0.858575, -0.0756447, 0.507077, -0.200101, 0.86117, 0.467275, -0.472027, -0.502657, 0.724242, 0.163061, 1.42607, -0.369999)

[node name="LookHelper" type="Node3D" parent="." index="7"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.65, 0)

[node name="VectorCube" parent="AimHelper" index="0" instance=ExtResource("3_3vsup")]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 0, 0, 0)
visible = false

[node name="ShootCast" parent="AimHelper" index="2"]
visible = false
collision_mask = 13

[node name="Skeleton3D" parent="Puppet" index="2"]
bones/1/position = Vector3(-1.47433e-09, 0.879254, -0.0641973)
bones/2/rotation = Quaternion(-0.132068, 0.000761826, 0.00331814, 0.991235)
bones/4/rotation = Quaternion(0.0933063, 0.0133356, 0.0187667, 0.995371)
bones/5/rotation = Quaternion(-0.00894363, -3.08403e-06, -1.19329e-05, 0.99996)
bones/7/rotation = Quaternion(-0.171113, 0.242769, -0.500839, 0.812984)
bones/8/rotation = Quaternion(0.261831, 0.0351784, -0.0509817, 0.963124)
bones/9/rotation = Quaternion(-0.0349784, -0.332682, -0.00290831, 0.942386)
bones/11/rotation = Quaternion(-0.13984, -0.0290744, 0.151269, 0.978119)
bones/14/rotation = Quaternion(0.0613058, -0.16979, -0.0868486, 0.97973)
bones/17/rotation = Quaternion(-0.31906, -0.0327667, 0.248645, 0.913949)
bones/20/rotation = Quaternion(0.164088, 0.0895547, 0.527762, 0.828567)
bones/21/rotation = Quaternion(0.712482, -0.0251063, 0.138729, 0.687381)
bones/22/rotation = Quaternion(0.196467, 0.216524, -0.0397008, 0.95548)
bones/24/rotation = Quaternion(-0.149634, 0.0496249, -0.153587, 0.975478)
bones/25/rotation = Quaternion(-0.0727763, 0.00448544, 0.0388242, 0.996582)
bones/27/rotation = Quaternion(0.105207, 0.155656, 0.115106, 0.975425)
bones/28/rotation = Quaternion(0.0689669, -0.146472, -0.0442372, 0.985816)
bones/30/rotation = Quaternion(-0.5472, -0.395885, 0.598797, 0.430452)
bones/33/rotation = Quaternion(-0.576509, 0.195675, -0.197243, 0.768403)
bones/34/rotation = Quaternion(-0.132943, 0.00380006, 0.203681, 0.969962)
bones/35/rotation = Quaternion(0.280292, -0.126208, -0.659355, 0.686119)
bones/38/rotation = Quaternion(-0.513838, -0.0391272, 0.354544, 0.780217)
bones/39/rotation = Quaternion(-0.165132, -0.00373466, -0.252997, 0.953263)
bones/40/rotation = Quaternion(0.233984, 0.12522, 0.54013, 0.798643)

[node name="Head" parent="Puppet/Skeleton3D" index="1"]
transform = Transform3D(-1, -6.27134e-05, 1.34294e-05, -6.41216e-05, 0.971406, -0.237425, 1.84341e-06, -0.237425, -0.971406, -1.02804e-05, 1.55931, -0.051588)

[node name="HeadArea" parent="Puppet/Skeleton3D/Head" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Neck" parent="Puppet/Skeleton3D" index="2"]
transform = Transform3D(-1, -3.86536e-05, 8.1677e-06, -3.94719e-05, 0.967004, -0.254762, 1.94833e-06, -0.254762, -0.967004, -7.79936e-06, 1.49724, -0.0352358)

[node name="NeckArea" parent="Puppet/Skeleton3D/Neck" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Chest" parent="Puppet/Skeleton3D" index="3"]
transform = Transform3D(-0.999977, 0.00677944, -0.000634235, 0.00657438, 0.98556, 0.169198, 0.00177215, 0.16919, -0.985582, -2.38092e-09, 1.11742, -0.0868667)

[node name="ChestArea" parent="Puppet/Skeleton3D/Chest" index="0"]
collision_layer = 8
collision_mask = 1

[node name="Stomach" parent="Puppet/Skeleton3D" index="4"]
transform = Transform3D(-1, -3.78941e-09, -3.89234e-07, 3.31093e-08, 0.995501, -0.0947544, 3.87842e-07, -0.0947544, -0.995501, -1.47433e-09, 0.879254, -0.0641973)

[node name="StomachArea" parent="Puppet/Skeleton3D/Stomach" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_UpperArm" parent="Puppet/Skeleton3D" index="5"]
transform = Transform3D(0.989806, 0.139245, -0.0299013, 0.128389, -0.781538, 0.610504, 0.0616406, -0.60812, -0.791448, 0.194955, 1.38013, -0.0396235)

[node name="R_UpperArmArea" parent="Puppet/Skeleton3D/R_UpperArm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Forearm" parent="Puppet/Skeleton3D" index="6"]
transform = Transform3D(0.965091, -0.260752, 0.0246407, 0.143949, 0.606663, 0.781818, -0.218809, -0.750978, 0.62302, 0.224012, 1.21705, -0.166521)

[node name="R_ForearmArea" parent="Puppet/Skeleton3D/R_Forearm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Hand" parent="Puppet/Skeleton3D" index="7"]
transform = Transform3D(0.858575, -0.0756447, 0.507077, -0.200101, 0.86117, 0.467275, -0.472027, -0.502657, 0.724242, 0.170481, 1.34159, -0.320693)

[node name="R_HandArea" parent="Puppet/Skeleton3D/R_Hand" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_UpperArm" parent="Puppet/Skeleton3D" index="8"]
transform = Transform3D(0.979349, -0.178793, 0.0943822, -0.144447, -0.945414, -0.292108, 0.141457, 0.272442, -0.951717, -0.194966, 1.38012, -0.0396231)

[node name="L_UpperArmArea" parent="Puppet/Skeleton3D/L_UpperArm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Forearm" parent="Puppet/Skeleton3D" index="9"]
transform = Transform3D(0.977184, 0.00813069, 0.212241, -0.0403192, -0.973996, 0.222948, 0.208534, -0.226418, -0.951445, -0.232275, 1.18284, 0.017228)

[node name="L_ForearmArea" parent="Puppet/Skeleton3D/L_Forearm" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Hand" parent="Puppet/Skeleton3D" index="10"]
transform = Transform3D(0.894132, 0.0226279, -0.447232, 0.0911174, -0.987023, 0.132228, -0.438436, -0.15898, -0.88459, -0.230606, 0.982887, -0.0292541)

[node name="L_HandArea" parent="Puppet/Skeleton3D/L_Hand" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Thigh" parent="Puppet/Skeleton3D" index="11"]
transform = Transform3D(0.489754, 0.0653913, 0.869405, -0.349145, -0.899024, 0.2643, 0.798898, -0.43299, -0.41747, 0.0851499, 0.861765, -0.0593682)

[node name="R_ThighArea" parent="Puppet/Skeleton3D/R_Thigh" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Shin" parent="Puppet/Skeleton3D" index="12"]
transform = Transform3D(0.474418, 0.0182182, 0.880111, 0.152058, -0.986453, -0.0615463, 0.867067, 0.163026, -0.470762, 0.112625, 0.484031, -0.241293)

[node name="R_ShinArea" parent="Puppet/Skeleton3D/R_Shin" index="0"]
collision_layer = 8
collision_mask = 1

[node name="R_Foot" parent="Puppet/Skeleton3D" index="13"]
transform = Transform3D(0.245939, 0.0720783, 0.966602, -0.853541, -0.456466, 0.25121, 0.459327, -0.886817, -0.0507408, 0.11946, 0.113907, -0.180125)

[node name="R_FootArea" parent="Puppet/Skeleton3D/R_Foot" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Thigh" parent="Puppet/Skeleton3D" index="14"]
transform = Transform3D(0.499782, -0.0574629, -0.864243, -0.0401152, -0.998262, 0.0431755, -0.865222, 0.0130909, -0.501219, -0.0851499, 0.861764, -0.0593682)

[node name="L_ThighArea" parent="Puppet/Skeleton3D/L_Thigh" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Shin" parent="Puppet/Skeleton3D" index="15"]
transform = Transform3D(0.488828, -0.0270953, -0.871959, -0.432872, -0.875325, -0.215472, -0.757409, 0.482776, -0.439612, -0.109294, 0.442335, -0.053868)

[node name="L_ShinArea" parent="Puppet/Skeleton3D/L_Shin" index="0"]
collision_layer = 8
collision_mask = 1

[node name="L_Foot" parent="Puppet/Skeleton3D" index="16"]
transform = Transform3D(0.245938, -0.0720762, -0.966602, 0.853542, -0.456466, 0.251209, -0.459327, -0.886817, -0.0507421, -0.11946, 0.113907, 0.127273)

[node name="L_FootArea" parent="Puppet/Skeleton3D/L_Foot" index="0"]
collision_layer = 8
collision_mask = 1

[node name="VisTimer" type="Timer" parent="." index="11"]
wait_time = 3.0
one_shot = true

[node name="StuckTimer" type="Timer" parent="." index="12"]
wait_time = 3.0
one_shot = true

[node name="ShootTimer" type="Timer" parent="." index="13"]
one_shot = true

[connection signal="timeout" from="VisTimer" to="." method="_player_lost"]
[connection signal="timeout" from="StuckTimer" to="." method="_stuck"]

[editable path="Weapons/Pistol"]
[editable path="Weapons/Pistol/Mesh"]
[editable path="Weapons/SMG"]
[editable path="Weapons/SMG/Mesh"]
[editable path="Weapons/Rifle"]
[editable path="Weapons/Shotgun"]
[editable path="Puppet"]
